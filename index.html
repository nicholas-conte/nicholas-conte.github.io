<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Trendr â€” Daily Sales Rankings</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
@media(max-width:600px){input,select,textarea{font-size:16px!important}}

/* â”€â”€ THEMES â”€â”€ */
:root{
  --bg:#fafaf8;--bg2:#f3f0ea;--surface:#fff;--surface2:#f7f4ee;
  --border:#e8e5df;--border2:#d8d4cc;
  --text:#1a1a18;--text2:#444440;--muted:#8a8880;
  --accent:#c8a96e;--al:#f7f0e3;--ad:#a8893e;
  --green:#4caf7d;--red:#e05252;--blue:#4a90d9;
  --r:12px;--sh:0 1px 3px rgba(0,0,0,.06),0 4px 16px rgba(0,0,0,.04);
  --sh2:0 6px 28px rgba(0,0,0,.09);
  --cj:#ff6b35;--aw:#0061a0;--amz:#ff9900;--rap:#0066cc;
  --transition:background .25s,color .25s,border-color .25s,box-shadow .25s;
}
[data-theme="dark"]{
  --bg:#111110;--bg2:#1a1a18;--surface:#1e1e1c;--surface2:#252522;
  --border:#2e2e2a;--border2:#3a3a36;
  --text:#f0ede6;--text2:#c8c4bc;--muted:#6a6860;
  --al:#2a2218;--ad:#c8a96e;
  --sh:0 1px 3px rgba(0,0,0,.3),0 4px 16px rgba(0,0,0,.2);
  --sh2:0 6px 28px rgba(0,0,0,.4);
}

html{scroll-behavior:smooth}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;transition:var(--transition)}

/* â”€â”€ HEADER â”€â”€ */
header{background:var(--surface);border-bottom:1px solid var(--border);padding:0 2rem;position:sticky;top:0;z-index:200;transition:var(--transition);backdrop-filter:blur(8px)}
.hi{max-width:1280px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;height:60px;gap:.75rem}
.logo{font-family:'Playfair Display',serif;font-size:1.4rem;font-weight:700;letter-spacing:-.02em;display:flex;align-items:baseline;gap:5px;flex-shrink:0}
.ld{color:var(--accent)}
.ls{font-size:.6rem;font-weight:400;color:var(--muted);letter-spacing:.12em;text-transform:uppercase;margin-left:2px}
.hright{display:flex;align-items:center;gap:.6rem}
.lpill{display:flex;align-items:center;gap:5px;font-size:.72rem;color:var(--muted);background:var(--bg2);border:1px solid var(--border);padding:3px 10px;border-radius:20px;transition:var(--transition)}
.ldot{width:6px;height:6px;background:var(--green);border-radius:50%;animation:pulse 2s infinite;flex-shrink:0}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.25}}

/* Theme toggle */
.theme-btn{width:34px;height:34px;border-radius:50%;border:1px solid var(--border);background:var(--bg2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:.95rem;transition:var(--transition);flex-shrink:0}
.theme-btn:hover{border-color:var(--accent);background:var(--al)}

.sbtn{background:var(--bg2);border:1px solid var(--border);border-radius:8px;padding:5px 12px;font-family:'DM Sans',sans-serif;font-size:.78rem;font-weight:500;color:var(--text);cursor:pointer;transition:var(--transition);white-space:nowrap}
.sbtn:hover{background:var(--al);border-color:var(--accent)}

/* â”€â”€ TOAST â”€â”€ */
.toast-wrap{position:fixed;bottom:1.5rem;right:1.5rem;z-index:9999;display:flex;flex-direction:column;gap:.5rem;pointer-events:none}
.toast{background:var(--text);color:var(--bg);padding:.65rem 1rem;border-radius:10px;font-size:.8rem;font-weight:500;box-shadow:var(--sh2);opacity:0;transform:translateY(8px);transition:opacity .25s,transform .25s;pointer-events:none;max-width:260px}
.toast.show{opacity:1;transform:none}

/* â”€â”€ BACK TO TOP â”€â”€ */
.btt{position:fixed;bottom:1.5rem;left:1.5rem;z-index:198;width:38px;height:38px;border-radius:50%;background:var(--accent);border:none;color:#fff;font-size:1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 16px rgba(200,169,110,.4);opacity:0;pointer-events:none;transform:translateY(12px);transition:opacity .25s,transform .25s}
.btt.visible{opacity:1;pointer-events:all;transform:none}
.btt:hover{background:var(--ad)}

/* â”€â”€ MAIN â”€â”€ */
main{max-width:1280px;margin:0 auto;padding:2rem}

/* â”€â”€ HERO â”€â”€ */
.hero{margin-bottom:1.75rem;display:flex;align-items:flex-end;justify-content:space-between;flex-wrap:wrap;gap:1rem}
.ht h1{font-family:'Playfair Display',serif;font-size:clamp(1.55rem,3.5vw,2.4rem);font-weight:700;letter-spacing:-.03em;line-height:1.15}
.ht h1 em{font-style:italic;color:var(--accent)}
.ht p{color:var(--muted);font-size:.87rem;margin-top:.3rem}
.hstats{display:flex;gap:1.5rem}
.stat .sn{font-family:'Playfair Display',serif;font-size:1.5rem;font-weight:700;color:var(--accent)}
.stat .sl{font-size:.67rem;color:var(--muted);text-transform:uppercase;letter-spacing:.08em}

/* â”€â”€ NETWORK BAR â”€â”€ */
.nbar{display:flex;flex-wrap:wrap;gap:.45rem;margin-bottom:1.4rem}
.nchip{display:flex;align-items:center;gap:5px;padding:4px 11px;border-radius:20px;font-size:.72rem;font-weight:500;border:1.5px solid transparent;cursor:pointer;transition:all .15s}
.nchip.conn{color:#fff}
.nchip.disc{background:var(--bg2);border-color:var(--border);color:var(--muted)}
.nchip.disc:hover{border-color:var(--accent);color:var(--accent)}
.nchip.conn.cj{background:var(--cj)}.nchip.conn.awin{background:var(--aw)}
.nchip.conn.amazon{background:var(--amz)}.nchip.conn.rapidapi{background:var(--rap)}
.cdot{width:5px;height:5px;border-radius:50%;background:rgba(255,255,255,.7);flex-shrink:0}
.disc .cdot{background:var(--border)}
.bcount{font-size:.63rem;opacity:.8}

/* â”€â”€ CONTROLS â”€â”€ */
.controls{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1.3rem;align-items:center}
.tg{display:flex;background:var(--bg2);border:1px solid var(--border);border-radius:9px;padding:3px;gap:2px;transition:var(--transition)}
.tab{padding:5px 13px;border-radius:6px;border:none;background:transparent;font-family:'DM Sans',sans-serif;font-size:.79rem;font-weight:500;color:var(--muted);cursor:pointer;transition:all .15s;white-space:nowrap}
.tab.active{background:var(--surface);color:var(--text);box-shadow:0 1px 4px rgba(0,0,0,.1)}
.sp{flex:1}
select,input[type=text]{font-family:'DM Sans',sans-serif;font-size:.77rem;border:1px solid var(--border);border-radius:8px;padding:5px 10px;background:var(--surface);color:var(--text);cursor:pointer;outline:none;transition:var(--transition)}
select:focus,input[type=text]:focus{border-color:var(--accent)}
.sw{position:relative}
.sw input{padding-left:26px;width:175px}
.si{position:absolute;left:8px;top:50%;transform:translateY(-50%);font-size:.77rem;pointer-events:none;color:var(--muted)}
.rbtn{display:flex;align-items:center;gap:5px;padding:5px 11px;border:1px solid var(--border);border-radius:8px;background:var(--surface);font-family:'DM Sans',sans-serif;font-size:.77rem;color:var(--text);cursor:pointer;transition:all .15s}
.rbtn:hover{background:var(--al);border-color:var(--accent)}
.rbtn.loading svg{animation:spin .7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* â”€â”€ PER-PAGE â”€â”€ */
.ppc{display:flex;align-items:center;gap:.4rem;font-size:.77rem;color:var(--muted)}
.ppc select{padding:4px 8px;font-size:.73rem}

/* â”€â”€ SOURCE BADGE â”€â”€ */
.sb{display:inline-flex;align-items:center;gap:2px;font-size:.62rem;padding:2px 6px;border-radius:9px;font-weight:600}
.s-cj{background:rgba(255,107,53,.12);color:var(--cj)}
.s-awin{background:rgba(0,97,160,.1);color:var(--aw)}
.s-amazon{background:rgba(255,153,0,.12);color:var(--amz)}
.s-demo{background:var(--al);color:var(--ad)}
.s-rapidapi{background:rgba(0,102,204,.1);color:var(--rap)}

/* â”€â”€ GRID HEADER â”€â”€ */
.gh{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem;flex-wrap:wrap;gap:.5rem}
.gh-left{display:flex;align-items:center;gap:.75rem}
.gh h2{font-family:'Playfair Display',serif;font-size:1rem;font-weight:600}
.rc{font-size:.75rem;color:var(--muted)}

/* â”€â”€ GRID â”€â”€ */
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(225px,1fr));gap:.95rem;min-height:200px}

/* â”€â”€ CARD â”€â”€ */
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;box-shadow:var(--sh);transition:transform .2s,box-shadow .2s,var(--transition);animation:fu .3s ease both;will-change:transform}
.card:hover{transform:translateY(-4px);box-shadow:var(--sh2)}
@keyframes fu{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.ci{position:relative;aspect-ratio:1;overflow:hidden;background:var(--bg2)}
.ci img{width:100%;height:100%;object-fit:cover;transition:transform .35s;display:block}
/* Image fade-in on load */
.ci img{opacity:0;transition:opacity .3s,transform .35s}
.ci img.loaded{opacity:1}
.card:hover .ci img{transform:scale(1.055)}
.rb{position:absolute;top:8px;left:8px;min-width:27px;height:27px;border-radius:14px;padding:0 6px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.71rem;color:#fff;letter-spacing:-.01em}
.r1{background:linear-gradient(135deg,#d4af5a,#c8962a)}
.r2{background:linear-gradient(135deg,#aaa9a8,#888)}
.r3{background:linear-gradient(135deg,#c87c3a,#a0602a)}
.rn{background:rgba(0,0,0,.45)}
.tb{position:absolute;top:8px;right:8px;padding:2px 7px;border-radius:10px;font-size:.66rem;font-weight:600}
.tu{background:rgba(76,175,125,.18);color:var(--green)}
.td{background:rgba(224,82,82,.14);color:var(--red)}
.ts2{background:rgba(128,128,128,.12);color:var(--muted)}
.cb{padding:.8rem}
.ct{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:.22rem}
.cbrand{font-size:.66rem;font-weight:600;text-transform:uppercase;letter-spacing:.09em;color:var(--accent)}
.cname{font-size:.85rem;font-weight:500;line-height:1.35;margin-bottom:.48rem;color:var(--text)}
.ctags{display:flex;gap:.28rem;flex-wrap:wrap;margin-bottom:.55rem}
.tag{font-size:.64rem;padding:2px 7px;border-radius:10px;background:var(--al);color:var(--muted);transition:var(--transition)}
.cf{display:flex;align-items:center;justify-content:space-between}
.price{font-weight:600;font-size:.92rem;color:var(--text)}
.score{font-size:.66rem;color:var(--muted)}
.bbtn{padding:5px 12px;border-radius:7px;border:1.5px solid var(--border2);background:transparent;font-family:'DM Sans',sans-serif;font-size:.72rem;font-weight:600;color:var(--text);cursor:pointer;text-decoration:none;transition:all .15s;display:inline-block;white-space:nowrap}
.bbtn:hover{background:var(--accent);color:#fff;border-color:var(--accent)}

/* â”€â”€ SKELETON â”€â”€ */
.sk{background:linear-gradient(90deg,var(--bg2) 25%,var(--surface2) 50%,var(--bg2) 75%);background-size:200% 100%;animation:shim 1.5s infinite;border-radius:6px}
@keyframes shim{0%{background-position:200% 0}100%{background-position:-200% 0}}
.csk{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;transition:var(--transition)}
.skim{height:175px}.skb{padding:.8rem;display:flex;flex-direction:column;gap:7px}
.skl{height:10px}.skl.s{width:55%}.skl.m{width:75%}
.empty{text-align:center;padding:4rem 2rem;color:var(--muted);grid-column:1/-1}
.ei{font-size:2rem;margin-bottom:.7rem}

/* â”€â”€ PAGINATION â”€â”€ */
.pagination{display:flex;align-items:center;justify-content:center;gap:.4rem;margin-top:2rem;flex-wrap:wrap}
.pg-btn{min-width:36px;height:36px;padding:0 10px;border-radius:8px;border:1.5px solid var(--border);background:var(--surface);font-family:'DM Sans',sans-serif;font-size:.8rem;font-weight:500;color:var(--muted);cursor:pointer;transition:all .15s;display:flex;align-items:center;justify-content:center}
.pg-btn:hover:not(:disabled):not(.active){border-color:var(--accent);color:var(--accent);background:var(--al)}
.pg-btn.active{background:var(--accent);color:#fff;border-color:var(--accent);font-weight:600}
.pg-btn:disabled{opacity:.35;cursor:not-allowed}
.pg-btn.pg-dots{border:none;background:none;cursor:default;color:var(--muted)}
.pg-info{font-size:.76rem;color:var(--muted);text-align:center;margin-top:.6rem}

/* â”€â”€ MODAL â”€â”€ */
.ov{position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:300;display:flex;align-items:center;justify-content:center;padding:1rem;opacity:0;pointer-events:none;transition:opacity .2s}
.ov.open{opacity:1;pointer-events:all}
.modal{background:var(--surface);border-radius:16px;max-width:660px;width:100%;max-height:90vh;overflow-y:auto;box-shadow:0 24px 80px rgba(0,0,0,.2);transform:translateY(20px);transition:transform .2s,var(--transition)}
.ov.open .modal{transform:none}
.drag-handle{display:none;justify-content:center;padding:.55rem 0 .1rem}
.drag-handle div{width:36px;height:4px;background:var(--border2);border-radius:4px}
.mh{padding:1.4rem 1.4rem .75rem;border-bottom:1px solid var(--border);display:flex;align-items:flex-start;justify-content:space-between}
.mh h2{font-family:'Playfair Display',serif;font-size:1.2rem;font-weight:700}
.mh p{font-size:.77rem;color:var(--muted);margin-top:.2rem}
.xbtn{background:none;border:none;font-size:1.2rem;cursor:pointer;color:var(--muted);padding:2px;line-height:1}
.mb{padding:1.2rem 1.4rem}
.ns{margin-bottom:1.4rem}
.ns h3{font-size:.79rem;font-weight:600;text-transform:uppercase;letter-spacing:.09em;color:var(--muted);margin-bottom:.5rem;display:flex;align-items:center;gap:.45rem;flex-wrap:wrap}
.nl{display:inline-flex;align-items:center;gap:4px;padding:2px 9px;border-radius:10px;font-size:.68rem;font-weight:700;color:#fff;text-transform:none;letter-spacing:0}
.nl-cj{background:var(--cj)}.nl-aw{background:var(--aw)}.nl-amz{background:var(--amz)}.nl-rap{background:var(--rap)}
.fr{display:flex;gap:.5rem;align-items:center;margin-bottom:.45rem}
.fl{font-size:.76rem;font-weight:500;min-width:95px;color:var(--text2)}
.fr input{flex:1;padding:6px 10px;font-family:'DM Sans',sans-serif;font-size:.76rem;border:1px solid var(--border);border-radius:7px;outline:none;background:var(--bg2);color:var(--text);transition:border-color .15s,var(--transition)}
.fr input:focus{border-color:var(--accent)}
.fr input.conn{border-color:var(--green);background:rgba(76,175,125,.06)}
.fhint{font-size:.69rem;color:var(--muted);margin-bottom:.7rem;padding:.5rem .75rem;background:var(--bg2);border-radius:7px;line-height:1.55;transition:var(--transition)}
.fhint a{color:var(--accent)}
.btags{display:flex;flex-wrap:wrap;gap:.3rem;margin-bottom:.65rem}
.btag{font-size:.67rem;padding:2px 7px;border-radius:10px;background:var(--al);color:var(--ad);font-weight:500;transition:var(--transition)}
.mf{padding:.7rem 1.4rem 1.4rem;display:flex;gap:.7rem;justify-content:flex-end;align-items:center}
.btn{padding:6px 16px;border-radius:8px;font-family:'DM Sans',sans-serif;font-size:.8rem;font-weight:600;cursor:pointer;transition:all .15s;border:1.5px solid transparent}
.bg{background:transparent;border-color:var(--border);color:var(--text)}.bg:hover{background:var(--bg2)}
.ba{background:var(--accent);color:#fff;border-color:var(--accent)}.ba:hover{background:var(--ad);border-color:var(--ad)}
.smsg{font-size:.76rem;color:var(--green);display:none;align-items:center;gap:4px}

/* â”€â”€ DIVIDER â”€â”€ */
footer{border-top:1px solid var(--border);padding:1.4rem 2rem;text-align:center;font-size:.73rem;color:var(--muted);margin-top:3rem;transition:var(--transition)}

/* â”€â”€ TABLET â”€â”€ */
@media(max-width:900px){
  main{padding:1.25rem}
  .hstats{gap:1rem}.stat .sn{font-size:1.2rem}
  .grid{grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:.85rem}
  .controls{flex-wrap:wrap;gap:.45rem}.sp{display:none}
  .sw input{width:155px}
  .modal{max-width:540px}
}

/* â”€â”€ MOBILE â”€â”€ */
@media(max-width:600px){
  header{padding:0 .85rem}
  .hi{height:54px;gap:.5rem}
  .logo{font-size:1.15rem}
  .ls{display:none}
  .lpill{display:none}
  .sbtn{font-size:.73rem;padding:4px 9px}
  main{padding:.85rem}
  .hero{margin-bottom:1rem;gap:.45rem}
  .ht h1{font-size:1.4rem}
  .ht p{font-size:.78rem}
  .hstats{display:none}
  .nbar{flex-wrap:nowrap;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none;padding-bottom:3px;margin-bottom:.9rem}
  .nbar::-webkit-scrollbar{display:none}
  .nchip{white-space:nowrap;flex-shrink:0;font-size:.69rem;padding:4px 9px}
  .bcount{display:none}
  .tg{flex-wrap:nowrap;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none;width:100%}
  .tg::-webkit-scrollbar{display:none}
  .tab{white-space:nowrap;flex-shrink:0;font-size:.76rem;padding:5px 11px}
  .controls{flex-direction:row;flex-wrap:wrap;gap:.4rem;align-items:stretch}
  .sp{display:none}
  .sw{flex:1 1 100%}.sw input{width:100%}
  select{flex:1 1 calc(50% - .2rem);min-width:0;font-size:.74rem;padding:6px 7px}
  .rbtn{flex:1 1 100%;justify-content:center;padding:8px}
  .ppc{flex:1 1 100%;justify-content:flex-end}
  .grid{grid-template-columns:repeat(2,1fr);gap:.6rem}
  .ci{aspect-ratio:1}
  .rb{width:24px;height:24px;font-size:.64rem;top:6px;left:6px;min-width:24px;padding:0}
  .tb{font-size:.61rem;padding:2px 5px;top:6px;right:6px}
  .cb{padding:.62rem}
  .cbrand{font-size:.61rem}
  .cname{font-size:.79rem;line-height:1.3;margin-bottom:.38rem}
  .ctags{gap:.22rem;margin-bottom:.42rem}
  .tag{font-size:.59rem;padding:2px 5px}
  .price{font-size:.85rem}
  .score{font-size:.61rem}
  .bbtn{padding:5px 9px;font-size:.69rem}
  .gh{flex-wrap:wrap;gap:.35rem}
  .gh h2{font-size:.88rem}
  .rc{font-size:.69rem}
  .pagination{gap:.3rem;margin-top:1.5rem}
  .pg-btn{min-width:32px;height:32px;font-size:.74rem}
  .ov{padding:0;align-items:flex-end}
  .modal{border-radius:20px 20px 0 0;max-height:92vh;width:100%;max-width:100%}
  .drag-handle{display:flex}
  .mh{padding:1rem 1.1rem .6rem}
  .mh h2{font-size:1.05rem}.mh p{font-size:.72rem}
  .mb{padding:1rem 1.1rem}
  .ns{margin-bottom:1.1rem}
  .ns h3{font-size:.72rem}
  .fr{flex-direction:column;align-items:flex-start;gap:.28rem}
  .fl{min-width:unset;font-size:.72rem}
  .fr input{width:100%;padding:8px 10px}
  .fhint{font-size:.67rem}
  .mf{padding:.6rem 1.1rem 1.2rem;flex-wrap:wrap;gap:.45rem}
  .mf .btn{flex:1;text-align:center;padding:9px}
  .smsg{flex:1 1 100%}
  footer{padding:1.1rem .85rem;font-size:.69rem}
  .toast-wrap{bottom:1rem;right:.85rem;left:.85rem}
  .toast{max-width:100%}
  .btt{bottom:1rem;left:.85rem}
}
@media(max-width:380px){
  .grid{grid-template-columns:repeat(2,1fr);gap:.45rem}
  .ht h1{font-size:1.2rem}
  .cname{font-size:.75rem}
  .cb{padding:.52rem}
  select{font-size:.7rem}
}
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="hi">
    <div class="logo">Trendr<span class="ld">.</span><span class="ls">Daily Rankings</span></div>
    <div class="hright">
      <div class="lpill"><span class="ldot"></span><span id="liveText">Demo data</span></div>
      <button class="theme-btn" id="themeBtn" onclick="toggleTheme()" title="Toggle dark mode">ğŸŒ™</button>
      <button class="sbtn" onclick="openSettings()">âš™ APIs</button>
    </div>
  </div>
</header>

<!-- BACK TO TOP -->
<button class="btt" id="bttBtn" onclick="window.scrollTo({top:0,behavior:'smooth'})" title="Back to top">â†‘</button>

<!-- TOAST CONTAINER -->
<div class="toast-wrap" id="toastWrap"></div>

<!-- SETTINGS MODAL -->
<div class="ov" id="overlay" onclick="closeOnBg(event)">
  <div class="modal">
    <div class="drag-handle"><div></div></div>
    <div class="mh">
      <div><h2>Connect Data Networks</h2><p>Join once â†’ real product data from 30,000+ brands instantly</p></div>
      <button class="xbtn" onclick="closeSettings()">âœ•</button>
    </div>
    <div class="mb">
      <div class="ns">
        <h3><span class="nl nl-cj">CJ Affiliate</span> ~3,000 brands Â· Nike, Zappos, Nordstrom, Foot Lockerâ€¦</h3>
        <div class="fhint">1. <a href="https://developers.cj.com" target="_blank">developers.cj.com</a> â†’ API Keys â†’ create Publisher key<br>2. Find your Website ID in CJ account settings</div>
        <div class="btags" id="cj-btags"></div>
        <div class="fr"><span class="fl">API Key</span><input type="password" id="cj_key" placeholder="CJ Publisher API keyâ€¦"/></div>
        <div class="fr"><span class="fl">Website ID</span><input type="text" id="cj_wid" placeholder="Your CJ publisher/website IDâ€¦"/></div>
      </div>
      <div class="ns">
        <h3><span class="nl nl-aw">Awin</span> ~25,000 brands Â· Adidas, Lululemon, ASOS, Zara, H&Mâ€¦</h3>
        <div class="fhint">1. <a href="https://ui.awin.com/user/account/api" target="_blank">ui.awin.com</a> â†’ My Account â†’ API â†’ generate key<br>2. Publisher ID shown top-right of Awin dashboard</div>
        <div class="btags" id="awin-btags"></div>
        <div class="fr"><span class="fl">API Key</span><input type="password" id="awin_key" placeholder="Awin API keyâ€¦"/></div>
        <div class="fr"><span class="fl">Publisher ID</span><input type="text" id="awin_pub" placeholder="Your Awin publisher IDâ€¦"/></div>
      </div>
      <div class="ns">
        <h3><span class="nl nl-amz">Amazon PA-API</span> All brands on Amazon Â· hourly bestseller rank</h3>
        <div class="fhint">1. <a href="https://affiliate-program.amazon.com" target="_blank">affiliate-program.amazon.com</a> â†’ sign up (same-day)<br>2. Tools â†’ Product Advertising API â†’ Manage credentials</div>
        <div class="btags" id="amz-btags"></div>
        <div class="fr"><span class="fl">Access Key</span><input type="password" id="amz_acc" placeholder="AWS Access Key IDâ€¦"/></div>
        <div class="fr"><span class="fl">Secret Key</span><input type="password" id="amz_sec" placeholder="AWS Secret Access Keyâ€¦"/></div>
        <div class="fr"><span class="fl">Associate ID</span><input type="text" id="amz_aid" placeholder="yoursite-20"/></div>
      </div>
      <div class="ns">
        <h3><span class="nl nl-rap">RapidAPI</span> Fallback Â· works immediately</h3>
        <div class="fhint">Free key at <a href="https://rapidapi.com/letscrape-6bJTR3j6sn/api/real-time-product-search" target="_blank">RapidAPI â†’ Real-Time Product Search</a>. 100 req/month free.</div>
        <div class="fr"><span class="fl">API Key</span><input type="password" id="rap_key" placeholder="RapidAPI keyâ€¦"/></div>
      </div>
    </div>
    <div class="mf">
      <span class="smsg" id="smsg">âœ… Saved!</span>
      <button class="btn bg" onclick="closeSettings()">Cancel</button>
      <button class="btn ba" onclick="saveKeys()">Save & Connect</button>
    </div>
  </div>
</div>

<!-- MAIN -->
<main>
  <div class="hero">
    <div class="ht">
      <h1>Today's <em>Best Sellers</em></h1>
      <p>Daily rankings across 30,000+ brands â€” powered by CJ, Awin &amp; Amazon</p>
    </div>
    <div class="hstats">
      <div class="stat"><div class="sn" id="sBrands">â€”</div><div class="sl">Brands</div></div>
      <div class="stat"><div class="sn" id="sProds">â€”</div><div class="sl">Products</div></div>
      <div class="stat"><div class="sn" id="sNets">0</div><div class="sl">Networks</div></div>
    </div>
  </div>

  <div class="nbar" id="nbar"></div>

  <div class="controls">
    <div class="tg">
      <button class="tab active" onclick="setCat('womens',this)">Women's</button>
      <button class="tab" onclick="setCat('mens',this)">Men's</button>
      <button class="tab" onclick="setCat('sneakers',this)">Sneakers</button>
      <button class="tab" onclick="setCat('accessories',this)">Accessories</button>
    </div>
    <div class="sp"></div>
    <div class="sw"><span class="si">ğŸ”</span><input type="text" id="srch" placeholder="Searchâ€¦" oninput="onFilterChange()"/></div>
    <select id="fBrand" onchange="onFilterChange()"><option value="">All Brands</option></select>
    <select id="fColor" onchange="onFilterChange()">
      <option value="">All Colors</option>
      <option>Black</option><option>White</option><option>Grey</option><option>Blue</option><option>Pink</option>
      <option>Green</option><option>Red</option><option>Purple</option><option>Brown</option><option>Beige</option>
    </select>
    <select id="fSize" onchange="onFilterChange()">
      <option value="">All Sizes</option>
      <option>XS</option><option>S</option><option>M</option><option>L</option><option>XL</option><option>XXL</option>
      <option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option>
    </select>
    <select id="fPrice" onchange="onFilterChange()">
      <option value="">Any Price</option>
      <option value="0-50">Under $50</option>
      <option value="50-100">$50 â€“ $100</option>
      <option value="100-200">$100 â€“ $200</option>
      <option value="200+">$200+</option>
    </select>
    <select id="fSort" onchange="onFilterChange()">
      <option value="rank">Top Ranked</option>
      <option value="price-asc">Price â†‘</option>
      <option value="price-desc">Price â†“</option>
      <option value="score">Popularity</option>
    </select>
    <div class="ppc">
      <span>Show</span>
      <select id="perPage" onchange="onPerPageChange()">
        <option value="12">12</option>
        <option value="24">24</option>
        <option value="48">48</option>
        <option value="96">96</option>
      </select>
    </div>
    <button class="rbtn" id="rbtn" onclick="loadData()">
      <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg>
      Refresh
    </button>
  </div>

  <div class="gh">
    <div class="gh-left">
      <h2 id="gtitle">Women's â€” All Brands</h2>
      <span class="rc" id="rcount"></span>
    </div>
  </div>

  <div class="grid" id="grid"></div>
  <div class="pagination" id="pagination"></div>
  <p class="pg-info" id="pgInfo"></p>
</main>

<footer>Trendr Â© 2025 &nbsp;Â·&nbsp; Connect CJ + Awin + Amazon for live data across 30,000+ brands &nbsp;Â·&nbsp; Rankings refresh daily</footer>

<script>
'use strict';
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let cat = 'womens';
let allProds = [];
let filtered = [];
let currentPage = 1;
let perPage = 12;

// Simple localStorage helpers
const LS = { cj:'trendr_cj_key',cj_wid:'trendr_cj_wid',awin:'trendr_awin_key',awin_pub:'trendr_awin_pub',amz:'trendr_amz_acc',amz_sec:'trendr_amz_sec',amz_aid:'trendr_amz_aid',rap:'trendr_rap_key' };
const lsGet = k => localStorage.getItem(LS[k])||'';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// THEME
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initTheme() {
  const saved = localStorage.getItem('trendr_theme');
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const theme = saved || (prefersDark ? 'dark' : 'light');
  applyTheme(theme);
}
function applyTheme(theme) {
  document.documentElement.setAttribute('data-theme', theme);
  document.getElementById('themeBtn').textContent = theme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
  localStorage.setItem('trendr_theme', theme);
}
function toggleTheme() {
  const cur = document.documentElement.getAttribute('data-theme');
  applyTheme(cur === 'dark' ? 'light' : 'dark');
  toast(cur === 'dark' ? 'â˜€ï¸ Light mode' : 'ğŸŒ™ Dark mode');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toast(msg, dur=2200) {
  const wrap = document.getElementById('toastWrap');
  const el = document.createElement('div');
  el.className = 'toast';
  el.textContent = msg;
  wrap.appendChild(el);
  requestAnimationFrame(() => { el.classList.add('show'); });
  setTimeout(() => {
    el.classList.remove('show');
    setTimeout(() => el.remove(), 300);
  }, dur);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BACK TO TOP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.addEventListener('scroll', () => {
  const btn = document.getElementById('bttBtn');
  if (window.scrollY > 400) btn.classList.add('visible');
  else btn.classList.remove('visible');
}, { passive: true });

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NETWORK DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const NETS = [
  { id:'cj',       lk:'cj',  label:'CJ Affiliate', count:'3,000',  brands:['Nike','Zappos','Nordstrom','J.Crew','DSW','Foot Locker','Ann Taylor','Calvin Klein','Tommy Hilfiger','Athleta','Express','Talbots','Lane Bryant','BCBG','Lucky Brand'] },
  { id:'awin',     lk:'awin',label:'Awin',          count:'25,000', brands:['Adidas','Lululemon','ASOS','H&M','Zara','Farfetch','NET-A-PORTER','Revolve','Free People','Anthropologie','Urban Outfitters','Ted Baker','AllSaints','Reiss','Boohoo','Nasty Gal'] },
  { id:'amazon',   lk:'amz', label:'Amazon PA-API', count:'âˆ',      brands:['Under Armour','Puma','New Balance','Champion','Reebok','Fila','Saucony','Brooks','Asics','Columbia','The North Face','Patagonia','Uniqlo','Gap','Old Navy','Carhartt'] },
  { id:'rapidapi', lk:'rap', label:'RapidAPI',      count:'500',    brands:['Nike','Adidas','Lululemon','Puma','Under Armour'] },
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DEMO DATA â€” 4 categories, 12 each
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const I = {
  ll:'https://images.unsplash.com/photo-1506629082955-511b1aa562c8?w=500&q=75',
  nw:'https://images.unsplash.com/photo-1571945153237-4929e783af4a?w=500&q=75',
  ad:'https://images.unsplash.com/photo-1583744946564-b52ac1c389c8?w=500&q=75',
  fp:'https://images.unsplash.com/photo-1485462537746-965f33f39ed0?w=500&q=75',
  as:'https://images.unsplash.com/photo-1434682881908-b43d0467b798?w=500&q=75',
  pu:'https://images.unsplash.com/photo-1578681994506-b8f463449011?w=500&q=75',
  rv:'https://images.unsplash.com/photo-1552902865-b72c031ac5ea?w=500&q=75',
  za:'https://images.unsplash.com/photo-1445205170230-053b83016050?w=500&q=75',
  an:'https://images.unsplash.com/photo-1539109136881-3be0616acf4b?w=500&q=75',
  nm:'https://images.unsplash.com/photo-1556821840-3a63f15732ce?w=500&q=75',
  nf:'https://images.unsplash.com/photo-1512436991641-6745cdb1723f?w=500&q=75',
  nb:'https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=500&q=75',
  ch:'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=500&q=75',
  jd:'https://images.unsplash.com/photo-1556906781-9a412961a28c?w=500&q=75',
  cn:'https://images.unsplash.com/photo-1587825140708-dfaf72ae4b04?w=500&q=75',
  vn:'https://images.unsplash.com/photo-1525966222134-fcfa99b8ae77?w=500&q=75',
  hm:'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=500&q=75',
  mg:'https://images.unsplash.com/photo-1595777457583-95e059d581b8?w=500&q=75',
};
const P = (r,br,n,pr,co,sz,sc,tr,im,url,src='demo') => ({rank:r,brand:br,name:n,price:pr,color:co,size:sz,sales:sc,trend:tr,img:I[im]||I.as,url,src});

const DEMO = {
  womens:[
    P(1,'Lululemon','Align High-Rise Pant 28"',128,'Black','M',18420,'up','ll','https://lululemon.com'),
    P(2,'Nike','Dri-FIT One Luxe Tight',75,'Grey','S',15300,'up','nw','https://nike.com'),
    P(3,'Adidas','Essentials 3-Stripes Hoodie',55,'White','L',12900,'same','ad','https://adidas.com'),
    P(4,'Free People','Movement Sunny Side Legging',98,'Pink','XS',10100,'up','fp','https://freepeople.com'),
    P(5,'ASOS','Premium Floral Midi Dress',68,'Blue','M',9800,'down','as','https://asos.com'),
    P(6,'Revolve','NBD Mini Dress',158,'Black','XS',9100,'up','rv','https://revolve.com'),
    P(7,'Zara','Ribbed Knit Cardigan',39,'Beige','M',8700,'up','za','https://zara.com'),
    P(8,'Anthropologie','Denim Embroidered Jacket',148,'Blue','S',8200,'same','an','https://anthropologie.com'),
    P(9,'Puma','Favourite Blaster Jacket',85,'Black','XL',7600,'up','pu','https://puma.com'),
    P(10,'H&M','Flowy Satin Blouse',24,'White','M',7100,'down','hm','https://hm.com'),
    P(11,'Mango','Asymmetric Hem Dress',59,'Black','S',6800,'up','mg','https://mango.com'),
    P(12,'Lululemon','Swiftly Tech Long Sleeve',88,'Green','M',6400,'same','fp','https://lululemon.com'),
  ],
  mens:[
    P(1,'Nike','Tech Fleece Full-Zip Hoodie',130,'Black','L',21000,'up','nm','https://nike.com'),
    P(2,'Adidas','Tiro 23 Track Jacket',70,'Blue','M',16500,'up','ad','https://adidas.com'),
    P(3,'Lululemon','ABC Slim-Fit Chino',148,'Grey','M',13400,'same','ll','https://lululemon.com'),
    P(4,'The North Face','Apex Bionic Jacket',229,'Black','L',11800,'up','nf','https://thenorthface.com'),
    P(5,'Champion','Reverse Weave Hoodie',75,'Grey','XL',10200,'up','ch','https://champion.com'),
    P(6,'Puma','Essentials Logo Shorts',35,'Grey','M',9400,'same','pu','https://puma.com'),
    P(7,'H&M','Regular Fit Oxford Shirt',29,'White','M',8900,'down','hm','https://hm.com'),
    P(8,'Zara','Straight Leg Chino',49,'Beige','M',8400,'up','za','https://zara.com'),
    P(9,'ASOS','Slim Suit Jacket',89,'Blue','M',7800,'same','as','https://asos.com'),
    P(10,'Adidas','Ultraboost Running Tee',35,'White','L',7200,'up','ad','https://adidas.com'),
    P(11,'Nike','Pro Dri-FIT Shorts',40,'Black','M',6800,'up','nm','https://nike.com'),
    P(12,'Lululemon','Surge Hybrid Short',98,'Blue','L',6100,'down','ll','https://lululemon.com'),
  ],
  sneakers:[
    P(1,'Nike','Air Force 1 \'07',110,'White','10',24500,'up','vn','https://nike.com'),
    P(2,'New Balance','574 Core',89,'Grey','9',19300,'up','nb','https://newbalance.com'),
    P(3,'Adidas','Stan Smith',90,'White','10',17800,'same','ad','https://adidas.com'),
    P(4,'Jordan','Air Jordan 1 Retro High',180,'Black','11',15600,'up','jd','https://jordan.com'),
    P(5,'Converse','Chuck Taylor All Star',65,'Black','9',13900,'same','cn','https://converse.com'),
    P(6,'Vans','Old Skool',70,'Black','10',12400,'up','vn','https://vans.com'),
    P(7,'Asics','Gel-Nimbus 25',160,'Blue','10',10800,'up','as','https://asics.com'),
    P(8,'Puma','RS-X Sneakers',90,'White','9',8700,'up','pu','https://puma.com'),
    P(9,'Nike','React Infinity Run Flyknit',160,'Blue','10',7900,'same','nw','https://nike.com'),
    P(10,'New Balance','990v5 Made in USA',185,'Grey','11',7200,'up','nb','https://newbalance.com'),
    P(11,'Adidas','Ultraboost 22',190,'Black','10',6500,'down','ad','https://adidas.com'),
    P(12,'Champion','C Logo Low Cut',65,'White','9',5900,'same','ch','https://champion.com'),
  ],
  accessories:[
    P(1,'Lululemon','Everywhere Belt Bag 1L',38,'Black','',14200,'up','ll','https://lululemon.com'),
    P(2,'Nike','Heritage Backpack',55,'Grey','',11800,'up','nm','https://nike.com'),
    P(3,'ASOS','Oversized Square Sunglasses',22,'Black','',10400,'same','as','https://asos.com'),
    P(4,'Adidas','Linear Core Tote Bag',30,'Black','',9600,'up','ad','https://adidas.com'),
    P(5,'Zara','Chain Detail Bucket Hat',25,'Beige','',8800,'up','za','https://zara.com'),
    P(6,'Revolve','LACK OF COLOR Boater Hat',68,'Black','',8100,'down','rv','https://revolve.com'),
    P(7,'Free People','Sol Searcher Crossbody',68,'Brown','',7500,'same','fp','https://freepeople.com'),
    P(8,'Puma','Training Gym Bag',45,'Black','',6900,'up','pu','https://puma.com'),
    P(9,'H&M','Ribbed Knit Beanie',12,'Grey','',6200,'up','hm','https://hm.com'),
    P(10,'Mango','Mini Croc-Effect Bag',59,'Black','',5800,'down','mg','https://mango.com'),
    P(11,'The North Face','Base Camp Duffel S',110,'Black','',5300,'same','nf','https://thenorthface.com'),
    P(12,'Champion','Script Logo Cap',28,'White','',4900,'up','ch','https://champion.com'),
  ]
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NETWORK BAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderNBar() {
  const live = NETS.filter(n => lsGet(n.lk)).map(n => n.id);
  document.getElementById('nbar').innerHTML = NETS.map(n => `
    <div class="nchip ${live.includes(n.id)?'conn '+n.id:'disc'}" onclick="openSettings()">
      <span class="cdot"></span>
      <strong>${n.label}</strong>
      <span class="bcount">${n.count === 'âˆ' ? 'All Amazon brands' : n.count+' brands'}</span>
    </div>`).join('');
  document.getElementById('sNets').textContent = live.length;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderModalContent() {
  NETS.forEach(n => {
    const el = document.getElementById(n.id+'-btags');
    if (el) el.innerHTML = n.brands.map(b=>`<span class="btag">${b}</span>`).join('')+`<span class="btag" style="opacity:.5">+more</span>`;
  });
  const vals = {cj_key:lsGet('cj'),cj_wid:lsGet('cj_wid'),awin_key:lsGet('awin'),awin_pub:lsGet('awin_pub'),amz_acc:lsGet('amz'),amz_sec:lsGet('amz_sec'),amz_aid:lsGet('amz_aid'),rap_key:lsGet('rap')};
  Object.entries(vals).forEach(([id,v]) => { const el=document.getElementById(id); if(el){el.value=v;if(v)el.classList.add('conn');} });
}
function saveKeys() {
  const map = {cj_key:'cj',cj_wid:'cj_wid',awin_key:'awin',awin_pub:'awin_pub',amz_acc:'amz',amz_sec:'amz_sec',amz_aid:'amz_aid',rap_key:'rap'};
  Object.entries(map).forEach(([id,lk])=>{ const v=document.getElementById(id)?.value?.trim()||''; if(v) localStorage.setItem(LS[lk],v); });
  document.getElementById('smsg').style.display='flex';
  setTimeout(()=>{ document.getElementById('smsg').style.display='none'; closeSettings(); renderNBar(); loadData(); toast('âœ… API keys saved!'); },900);
}
function openSettings(){ renderModalContent(); document.getElementById('overlay').classList.add('open'); }
function closeSettings(){ document.getElementById('overlay').classList.remove('open'); }
function closeOnBg(e){ if(e.target.id==='overlay') closeSettings(); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CATEGORY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CLABELS = {womens:"Women's",mens:"Men's",sneakers:"Sneakers",accessories:"Accessories"};

function setCat(c, btn) {
  cat = c; currentPage = 1;
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  btn.classList.add('active');
  ['fBrand','fColor','fSize','fPrice','fSort'].forEach(id=>document.getElementById(id).selectedIndex=0);
  document.getElementById('srch').value='';
  loadData();
}

function populateBrands(prods) {
  const brands = [...new Set(prods.map(p=>p.brand))].sort();
  const sel = document.getElementById('fBrand');
  const cur = sel.value;
  sel.innerHTML = '<option value="">All Brands</option>'+brands.map(b=>`<option${b===cur?' selected':''}>${b}</option>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FILTERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function onFilterChange() { currentPage = 1; applyFilters(); }
function onPerPageChange() { perPage = parseInt(document.getElementById('perPage').value); currentPage = 1; renderPage(); }

function applyFilters() {
  let f = [...allProds];
  const brand = document.getElementById('fBrand').value;
  const color = document.getElementById('fColor').value;
  const size  = document.getElementById('fSize').value;
  const price = document.getElementById('fPrice').value;
  const sort  = document.getElementById('fSort').value;
  const srch  = document.getElementById('srch').value.toLowerCase().trim();

  if (brand) f = f.filter(p=>p.brand===brand);
  if (color) f = f.filter(p=>p.color.toLowerCase().includes(color.toLowerCase()));
  if (size)  f = f.filter(p=>!p.size||p.size===size);
  if (srch)  f = f.filter(p=>p.name.toLowerCase().includes(srch)||p.brand.toLowerCase().includes(srch));
  if (price==='200+') f=f.filter(p=>p.price>=200);
  else if(price){const[lo,hi]=price.split('-').map(Number);f=f.filter(p=>p.price>=lo&&p.price<=hi);}
  if(sort==='price-asc')  f.sort((a,b)=>a.price-b.price);
  if(sort==='price-desc') f.sort((a,b)=>b.price-a.price);
  if(sort==='score')      f.sort((a,b)=>b.sales-a.sales);
  if(sort==='rank')       f.sort((a,b)=>a.rank-b.rank);

  filtered = f;
  const bl = brand||'All Brands';
  const cl = color?` Â· ${color}`:'';
  document.getElementById('gtitle').textContent = `${CLABELS[cat]} â€” ${bl}${cl}`;
  document.getElementById('rcount').textContent = `${f.length} item${f.length!==1?'s':''}`;
  renderPage();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGINATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderPage() {
  const total = filtered.length;
  const totalPages = Math.max(1, Math.ceil(total / perPage));
  if (currentPage > totalPages) currentPage = totalPages;

  const start = (currentPage - 1) * perPage;
  const end   = Math.min(start + perPage, total);
  const pageItems = filtered.slice(start, end);

  renderProds(pageItems);
  renderPagination(totalPages);

  if (total > 0) {
    document.getElementById('pgInfo').textContent = `Showing ${start+1}â€“${end} of ${total} items`;
  } else {
    document.getElementById('pgInfo').textContent = '';
  }
}

function goPage(n) {
  currentPage = n;
  renderPage();
  // Smooth scroll to grid top
  document.getElementById('grid').scrollIntoView({behavior:'smooth', block:'start'});
}

function renderPagination(totalPages) {
  const pg = document.getElementById('pagination');
  if (totalPages <= 1) { pg.innerHTML = ''; return; }

  const cur = currentPage;
  let html = '';

  // Prev
  html += `<button class="pg-btn" onclick="goPage(${cur-1})" ${cur===1?'disabled':''}>â€¹</button>`;

  // Page numbers with ellipsis
  const pages = getPageNumbers(cur, totalPages);
  pages.forEach(p => {
    if (p === '...') {
      html += `<button class="pg-btn pg-dots" disabled>â€¦</button>`;
    } else {
      html += `<button class="pg-btn${p===cur?' active':''}" onclick="goPage(${p})">${p}</button>`;
    }
  });

  // Next
  html += `<button class="pg-btn" onclick="goPage(${cur+1})" ${cur===totalPages?'disabled':''}>â€º</button>`;

  pg.innerHTML = html;
}

function getPageNumbers(cur, total) {
  if (total <= 7) return Array.from({length:total},(_,i)=>i+1);
  const pages = [];
  pages.push(1);
  if (cur > 3) pages.push('...');
  for (let i = Math.max(2, cur-1); i <= Math.min(total-1, cur+1); i++) pages.push(i);
  if (cur < total-2) pages.push('...');
  pages.push(total);
  return pages;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOAD DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadData() {
  const btn = document.getElementById('rbtn');
  btn.classList.add('loading');
  showSkel();

  const rapidKey = lsGet('rap');
  let loaded = false;

  if (rapidKey) {
    try { await fetchRapid(rapidKey); loaded = true; }
    catch(e) { console.warn('RapidAPI:', e); toast('âš ï¸ API fetch failed â€” showing demo data'); }
  }

  if (!loaded) {
    await new Promise(r=>setTimeout(r,350));
    allProds = DEMO[cat];
    document.getElementById('liveText').textContent = 'Demo â€” connect APIs for live data';
  }

  populateBrands(allProds);
  document.getElementById('sProds').textContent = allProds.length;
  document.getElementById('sBrands').textContent = [...new Set(allProds.map(p=>p.brand))].length;
  applyFilters();
  btn.classList.remove('loading');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// API FETCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const QUERIES = {
  womens:'womens athletic clothing Nike Adidas Lululemon Zara ASOS Free People',
  mens:'mens athletic clothing Nike Adidas Champion Zara H&M North Face',
  sneakers:'sneakers Nike Jordan New Balance Adidas Converse Vans Asics',
  accessories:'fashion accessories bags hats Lululemon Nike belt bag',
};
const BRANDS_DB = ['Nike','Adidas','Lululemon','Under Armour','Puma','New Balance','Reebok','Converse','Vans','Jordan','Asics','Fila','Saucony','Brooks','Champion','H&M','Zara','ASOS','Revolve','Free People','Anthropologie','Urban Outfitters','Mango','Ted Baker','Nordstrom','J.Crew','Gap','Old Navy','Banana Republic','Express','Forever 21','Patagonia','The North Face','Columbia','Uniqlo','Carhartt'];

async function fetchRapid(key) {
  const res = await fetch(
    `https://real-time-product-search.p.rapidapi.com/search?q=${encodeURIComponent(QUERIES[cat])}&country=us&language=en&limit=20`,
    { headers:{'X-RapidAPI-Key':key,'X-RapidAPI-Host':'real-time-product-search.p.rapidapi.com'} }
  );
  if (!res.ok) throw new Error(res.status);
  const data = await res.json();
  const raw = data.data||[];
  const mapped = raw.map((p,i)=>({
    rank:i+1, brand:exBrand(p.product_title),
    name:(p.product_title||'').slice(0,65),
    price:parseFloat((p.offer?.price||'0').replace(/[^0-9.]/g,''))||0,
    color:exColor(p.product_title), size:'',
    sales:rankSc(p), trend:['up','same','down'][i%3],
    img:p.product_photos?.[0]||I.as,
    url:p.offer?.store_link||p.product_page_url||'#', src:'rapidapi'
  }));
  mapped.sort((a,b)=>b.sales-a.sales).forEach((p,i)=>p.rank=i+1);
  allProds = mapped;
  const ts = new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
  document.getElementById('liveText').textContent = `Live Â· ${ts}`;
}

function rankSc(p){ return Math.round((parseInt(p.reviews?.total_reviews)||0)*(parseFloat(p.product_rating)||0)+(p.is_best_seller?1000:0)); }
function exBrand(t=''){ return BRANDS_DB.find(b=>t.toLowerCase().includes(b.toLowerCase()))||'Brand'; }
function exColor(t=''){ return ['Black','White','Grey','Blue','Pink','Green','Red','Purple','Brown','Beige','Orange','Navy'].find(c=>t.toLowerCase().includes(c.toLowerCase()))||''; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER CARDS â€” with lazy image loading
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderProds(prods) {
  const grid = document.getElementById('grid');
  if (!prods.length) {
    grid.innerHTML = `<div class="empty"><div class="ei">ğŸ”</div><p>No items match â€” try different filters.</p></div>`;
    return;
  }

  // Use DocumentFragment for performance
  const frag = document.createDocumentFragment();
  prods.forEach((p, i) => {
    const card = document.createElement('div');
    card.className = 'card';
    card.style.animationDelay = `${i * 0.035}s`;
    card.innerHTML = `
      <div class="ci">
        <img data-src="${p.img}" alt="${p.name}" loading="lazy" onerror="this.src='${I.as}'"/>
        <div class="rb ${rc(p.rank)}">#${p.rank}</div>
        <span class="tb ${tc(p.trend)}">${ti(p.trend)} ${cap(p.trend)}</span>
      </div>
      <div class="cb">
        <div class="ct"><span class="cbrand">${p.brand}</span><span class="sb s-${p.src}">${sl(p.src)}</span></div>
        <div class="cname">${p.name}</div>
        <div class="ctags">
          ${p.color?`<span class="tag">ğŸ¨ ${p.color}</span>`:''}
          ${p.size?`<span class="tag">ğŸ“ ${p.size}</span>`:''}
          ${p.sales>10000?'<span class="tag">ğŸ”¥ Hot</span>':''}
        </div>
        <div class="cf">
          <div><div class="price">${p.price>0?'$'+p.price.toFixed(2):'â€”'}</div><div class="score">${p.sales.toLocaleString()} score</div></div>
          <a class="bbtn" href="${p.url}" target="_blank" rel="noopener">Buy â†’</a>
        </div>
      </div>`;
    frag.appendChild(card);
  });

  grid.innerHTML = '';
  grid.appendChild(frag);

  // Intersection Observer lazy image loader
  const imgs = grid.querySelectorAll('img[data-src]');
  if ('IntersectionObserver' in window) {
    const obs = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          const img = e.target;
          img.src = img.dataset.src;
          img.onload = () => img.classList.add('loaded');
          img.onerror = () => { img.src = I.as; img.classList.add('loaded'); };
          obs.unobserve(img);
        }
      });
    }, { rootMargin: '200px' });
    imgs.forEach(img => obs.observe(img));
  } else {
    // Fallback for old browsers
    imgs.forEach(img => { img.src = img.dataset.src; img.classList.add('loaded'); });
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SKELETON (matches current perPage)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showSkel() {
  document.getElementById('grid').innerHTML = Array(Math.min(perPage, 12)).fill(`
    <div class="csk"><div class="sk skim"></div>
    <div class="skb"><div class="sk skl s"></div><div class="sk skl m"></div><div class="sk skl s"></div></div></div>`).join('');
  document.getElementById('pagination').innerHTML = '';
  document.getElementById('pgInfo').textContent = '';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function rc(r){ return r===1?'r1':r===2?'r2':r===3?'r3':'rn'; }
function tc(t){ return t==='up'?'tu':t==='down'?'td':'ts2'; }
function ti(t){ return t==='up'?'â†‘':t==='down'?'â†“':'â€”'; }
function cap(s){ return s.charAt(0).toUpperCase()+s.slice(1); }
function sl(s){ return {cj:'CJ',awin:'Awin',amazon:'Amazon',rapidapi:'Live',demo:'Demo'}[s]||'Demo'; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
initTheme();
renderNBar();
loadData();
</script>
</body>
</html>
