<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Trendr Shop ‚Äî Daily Sales Rankings</title>
<meta name="description" content="Daily rankings of the best-selling fashion and athletic apparel across Nike, Adidas, Lululemon, ASOS and 3,000+ brands. Updated daily."/>
<meta name="theme-color" content="#c8a96e"/>
<!-- Favicon -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üî•</text></svg>"/>
<!-- Open Graph -->
<meta property="og:title" content="Trendr Shop ‚Äî Today's Best Sellers"/>
<meta property="og:description" content="Daily sales rankings across Nike, Adidas, Lululemon and 3,000+ brands. Filter by color, size, price and more."/>
<meta property="og:url" content="https://trendrshop.me"/>
<meta property="og:type" content="website"/>
<!-- Twitter card -->
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Trendr Shop ‚Äî Daily Rankings"/>
<meta name="twitter:description" content="Best-selling fashion ranked daily across 3,000+ brands."/>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600;9..40,700&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
@media(max-width:600px){input,select,textarea{font-size:16px!important}}
/* ‚îÄ‚îÄ THEMES ‚îÄ‚îÄ */
:root{
  --bg:#fafaf8;--bg2:#f3f0ea;--surface:#fff;--surface2:#f7f4ee;
  --border:#e8e5df;--border2:#d8d4cc;
  --text:#1a1a18;--text2:#444440;--muted:#8a8880;
  --accent:#c8a96e;--al:#f7f0e3;--ad:#a8893e;
  --green:#4caf7d;--red:#e05252;--blue:#4a90d9;
  --r:12px;--sh:0 1px 3px rgba(0,0,0,.06),0 4px 16px rgba(0,0,0,.04);
  --sh2:0 6px 28px rgba(0,0,0,.09);
  --cj:#ff6b35;--aw:#0061a0;--amz:#ff9900;--rap:#0066cc;
  --transition:background .25s,color .25s,border-color .25s,box-shadow .25s;
}
[data-theme="dark"]{
  --bg:#111110;--bg2:#1a1a18;--surface:#1e1e1c;--surface2:#252522;
  --border:#2e2e2a;--border2:#3a3a36;
  --text:#f0ede6;--text2:#c8c4bc;--muted:#6a6860;
  --al:#2a2218;--ad:#c8a96e;
  --sh:0 1px 3px rgba(0,0,0,.3),0 4px 16px rgba(0,0,0,.2);
  --sh2:0 6px 28px rgba(0,0,0,.4);
}
html{scroll-behavior:smooth}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;transition:var(--transition)}
/* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
header{background:var(--surface);border-bottom:1px solid var(--border);padding:0 2rem;position:sticky;top:0;z-index:200;transition:var(--transition);backdrop-filter:blur(8px)}
.hi{max-width:1280px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;height:60px;gap:.75rem}
.logo{font-family:'Playfair Display',serif;font-size:1.4rem;font-weight:700;letter-spacing:-.02em;display:flex;align-items:baseline;gap:5px;flex-shrink:0}
.ld{color:var(--accent)}
.ls{font-size:.6rem;font-weight:400;color:var(--muted);letter-spacing:.12em;text-transform:uppercase;margin-left:2px}
.hright{display:flex;align-items:center;gap:.6rem}
/* Theme toggle */
.theme-btn{width:34px;height:34px;border-radius:50%;border:1px solid var(--border);background:var(--bg2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:.95rem;transition:var(--transition);flex-shrink:0}
.theme-btn:hover{border-color:var(--accent);background:var(--al)}
/* ‚îÄ‚îÄ COUNTDOWN BANNER (Desktop) ‚îÄ‚îÄ */
.countdown-banner{background:linear-gradient(135deg,var(--accent) 0%,var(--ad) 100%);padding:1rem 2rem;text-align:center;color:#fff;border-bottom:1px solid var(--border)}
.countdown-content{max-width:1280px;margin:0 auto;display:flex;align-items:center;justify-content:center;gap:1.5rem;flex-wrap:wrap}
.countdown-label{font-size:.85rem;font-weight:500;opacity:.9;letter-spacing:.05em;text-transform:uppercase}
.countdown-timer{display:flex;gap:.75rem;align-items:center}
.time-unit{display:flex;flex-direction:column;align-items:center;min-width:60px}
.time-value{font-family:'Playfair Display',serif;font-size:2rem;font-weight:700;line-height:1;text-shadow:0 2px 8px rgba(0,0,0,.2)}
.time-label{font-size:.65rem;opacity:.8;margin-top:.25rem;letter-spacing:.08em;text-transform:uppercase}
.time-sep{font-size:1.5rem;font-weight:700;opacity:.6;margin:0 -.25rem}
.status-pill{display:inline-flex;align-items:center;gap:6px;background:rgba(255,255,255,.15);padding:4px 12px;border-radius:20px;font-size:.72rem;backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.2)}
.status-dot{width:6px;height:6px;background:#fff;border-radius:50%;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
/* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
.toast-wrap{position:fixed;bottom:1.5rem;right:1.5rem;z-index:9999;display:flex;flex-direction:column;gap:.5rem;pointer-events:none}
.toast{background:var(--text);color:var(--bg);padding:.65rem 1rem;border-radius:10px;font-size:.8rem;font-weight:500;box-shadow:var(--sh2);opacity:0;transform:translateY(8px);transition:opacity .25s,transform .25s;pointer-events:none;max-width:260px}
.toast.show{opacity:1;transform:none}
/* ‚îÄ‚îÄ BACK TO TOP ‚îÄ‚îÄ */
.btt{position:fixed;bottom:1.5rem;left:1.5rem;z-index:198;width:38px;height:38px;border-radius:50%;background:var(--accent);border:none;color:#fff;font-size:1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 16px rgba(200,169,110,.4);opacity:0;pointer-events:none;transform:translateY(12px);transition:opacity .25s,transform .25s}
.btt.visible{opacity:1;pointer-events:all;transform:none}
.btt:hover{background:var(--ad)}
/* ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ */
main{max-width:1280px;margin:0 auto;padding:2rem}
/* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
.hero{margin-bottom:1.75rem;display:flex;align-items:flex-end;justify-content:space-between;flex-wrap:wrap;gap:1rem}
.ht h1{font-family:'Playfair Display',serif;font-size:clamp(1.55rem,3.5vw,2.4rem);font-weight:700;letter-spacing:-.03em;line-height:1.15}
.ht h1 em{font-style:italic;color:var(--accent)}
.ht p{color:var(--muted);font-size:.87rem;margin-top:.3rem}
.hstats{display:flex;gap:1.5rem}
.stat .sn{font-family:'Playfair Display',serif;font-size:1.5rem;font-weight:700;color:var(--accent)}
.stat .sl{font-size:.67rem;color:var(--muted);text-transform:uppercase;letter-spacing:.08em}
/* ‚îÄ‚îÄ CONTROLS ‚îÄ‚îÄ */
.controls{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1.3rem;align-items:center}
.tg{display:flex;background:var(--bg2);border:1px solid var(--border);border-radius:9px;padding:3px;gap:2px;transition:var(--transition)}
.tab{padding:5px 13px;border-radius:6px;border:none;background:transparent;font-family:'DM Sans',sans-serif;font-size:.79rem;font-weight:500;color:var(--muted);cursor:pointer;transition:all .15s;white-space:nowrap}
.tab.active{background:var(--surface);color:var(--text);box-shadow:0 1px 4px rgba(0,0,0,.1)}
.sp{flex:1}
select,input[type=text]{font-family:'DM Sans',sans-serif;font-size:.77rem;border:1px solid var(--border);border-radius:8px;padding:5px 10px;background:var(--surface);color:var(--text);cursor:pointer;outline:none;transition:var(--transition)}
select:focus,input[type=text]:focus{border-color:var(--accent)}
.sw{position:relative}
.sw input{padding-left:26px;width:175px}
.si{position:absolute;left:8px;top:50%;transform:translateY(-50%);font-size:.77rem;pointer-events:none;color:var(--muted)}
.rbtn{display:flex;align-items:center;gap:5px;padding:5px 11px;border:1px solid var(--border);border-radius:8px;background:var(--surface);font-family:'DM Sans',sans-serif;font-size:.77rem;color:var(--text);cursor:pointer;transition:all .15s}
.rbtn:hover{background:var(--al);border-color:var(--accent)}
.rbtn.loading svg{animation:spin .7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
/* ‚îÄ‚îÄ PER-PAGE ‚îÄ‚îÄ */
.ppc{display:flex;align-items:center;gap:.4rem;font-size:.77rem;color:var(--muted)}
.ppc select{padding:4px 8px;font-size:.73rem}
/* ‚îÄ‚îÄ SOURCE BADGE ‚îÄ‚îÄ */
.sb{display:inline-flex;align-items:center;gap:2px;font-size:.62rem;padding:2px 6px;border-radius:9px;font-weight:600}
.s-rapidapi{background:rgba(0,102,204,.1);color:var(--rap)}
.s-demo{background:var(--al);color:var(--ad)}
/* ‚îÄ‚îÄ GRID HEADER ‚îÄ‚îÄ */
.gh{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem;flex-wrap:wrap;gap:.5rem}
.gh-left{display:flex;align-items:center;gap:.75rem}
.gh h2{font-family:'Playfair Display',serif;font-size:1rem;font-weight:600}
.rc{font-size:.75rem;color:var(--muted)}
/* ‚îÄ‚îÄ GRID ‚îÄ‚îÄ */
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(225px,1fr));gap:.95rem;min-height:200px}
/* ‚îÄ‚îÄ CARD ‚îÄ‚îÄ */
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;box-shadow:var(--sh);transition:transform .2s,box-shadow .2s,var(--transition);animation:fu .3s ease both;will-change:transform}
.card:hover{transform:translateY(-4px);box-shadow:var(--sh2)}
@keyframes fu{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.ci{position:relative;aspect-ratio:1;overflow:hidden;background:var(--bg2)}
.ci img{width:100%;height:100%;object-fit:cover;object-position:center 30%;background:var(--bg2);transition:opacity .3s,transform .35s;display:block}
/* Image fade-in on load */
.ci img{opacity:0;transition:opacity .3s,transform .35s}
.ci img.loaded{opacity:1}
.card:hover .ci img{transform:scale(1.055)}
.rb{position:absolute;top:8px;left:8px;min-width:27px;height:27px;border-radius:14px;padding:0 6px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.71rem;color:#fff;letter-spacing:-.01em}
.r1{background:linear-gradient(135deg,#d4af5a,#c8962a)}
.r2{background:linear-gradient(135deg,#aaa9a8,#888)}
.r3{background:linear-gradient(135deg,#c87c3a,#a0602a)}
.rn{background:rgba(0,0,0,.45)}
.tb{position:absolute;top:8px;right:8px;padding:2px 7px;border-radius:10px;font-size:.66rem;font-weight:600}
.tu{background:rgba(76,175,125,.18);color:var(--green)}
.td{background:rgba(224,82,82,.14);color:var(--red)}
.ts2{background:rgba(128,128,128,.12);color:var(--muted)}
.cb{padding:.8rem}
.ct{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:.22rem}
.cbrand{font-size:.66rem;font-weight:600;text-transform:uppercase;letter-spacing:.09em;color:var(--accent)}
.cname{font-size:.85rem;font-weight:500;line-height:1.35;margin-bottom:.48rem;color:var(--text)}
.ctags{display:flex;gap:.28rem;flex-wrap:wrap;margin-bottom:.55rem}
.tag{font-size:.64rem;padding:2px 7px;border-radius:10px;background:var(--al);color:var(--muted);transition:var(--transition)}
.cf{display:flex;align-items:center;justify-content:space-between}
.price{font-weight:600;font-size:.92rem;color:var(--text)}
.score{font-size:.66rem;color:var(--muted)}
.bbtn{padding:5px 12px;border-radius:7px;border:1.5px solid var(--border2);background:transparent;font-family:'DM Sans',sans-serif;font-size:.72rem;font-weight:600;color:var(--text);cursor:pointer;text-decoration:none;transition:all .15s;display:inline-block;white-space:nowrap}
.bbtn:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
/* ‚îÄ‚îÄ SKELETON ‚îÄ‚îÄ */
.sk{background:linear-gradient(90deg,var(--bg2) 25%,var(--surface2) 50%,var(--bg2) 75%);background-size:200% 100%;animation:shim 1.5s infinite;border-radius:6px}
@keyframes shim{0%{background-position:200% 0}100%{background-position:-200% 0}}
.csk{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;transition:var(--transition)}
.skim{height:175px}.skb{padding:.8rem;display:flex;flex-direction:column;gap:7px}
.skl{height:10px}.skl.s{width:55%}.skl.m{width:75%}
.empty{text-align:center;padding:4rem 2rem;color:var(--muted);grid-column:1/-1}
.ei{font-size:2rem;margin-bottom:.7rem}
/* ‚îÄ‚îÄ PAGINATION ‚îÄ‚îÄ */
.pagination{display:flex;align-items:center;justify-content:center;gap:.4rem;margin-top:2rem;flex-wrap:wrap}
.pg-btn{min-width:36px;height:36px;padding:0 10px;border-radius:8px;border:1.5px solid var(--border);background:var(--surface);font-family:'DM Sans',sans-serif;font-size:.8rem;font-weight:500;color:var(--muted);cursor:pointer;transition:all .15s;display:flex;align-items:center;justify-content:center}
.pg-btn:hover:not(:disabled):not(.active){border-color:var(--accent);color:var(--accent);background:var(--al)}
.pg-btn.active{background:var(--accent);color:#fff;border-color:var(--accent);font-weight:600}
.pg-btn:disabled{opacity:.35;cursor:not-allowed}
.pg-btn.pg-dots{border:none;background:none;cursor:default;color:var(--muted)}
.pg-info{font-size:.76rem;color:var(--muted);text-align:center;margin-top:.6rem}
/* ‚îÄ‚îÄ STARS ‚îÄ‚îÄ */
.stars-row{display:flex;align-items:center;gap:4px;margin-bottom:.4rem}
.stars{color:#f5a623;font-size:.82rem;letter-spacing:1px}
.rating-num{font-size:.75rem;font-weight:600;color:var(--text)}
.rev-count{font-size:.68rem;color:var(--muted)}
.photo-count{position:absolute;bottom:8px;right:8px;background:rgba(0,0,0,.55);color:#fff;font-size:.65rem;padding:2px 7px;border-radius:10px;backdrop-filter:blur(4px)}
/* ‚îÄ‚îÄ GALLERY MODAL ‚îÄ‚îÄ */
.gov{position:fixed;inset:0;background:rgba(0,0,0,.88);z-index:400;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .2s;padding:1rem}
.gov.open{opacity:1;pointer-events:all}
.gmodal{background:var(--surface);border-radius:18px;max-width:900px;width:100%;max-height:92vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 32px 100px rgba(0,0,0,.4);transform:scale(.97);transition:transform .2s,var(--transition)}
.gov.open .gmodal{transform:scale(1)}
.g-viewer{position:relative;background:#000;flex-shrink:0}
.g-main-img{width:100%;height:360px;object-fit:contain;display:block;transition:opacity .2s}
.g-main-img.fading{opacity:0}
.g-nav{position:absolute;top:50%;transform:translateY(-50%);background:rgba(255,255,255,.15);border:none;color:#fff;width:40px;height:40px;border-radius:50%;font-size:1.1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.15s;backdrop-filter:blur(4px)}
.g-nav:hover{background:rgba(255,255,255,.3)}
.g-nav.prev{left:10px}.g-nav.next{right:10px}
.g-counter{position:absolute;bottom:10px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.5);color:#fff;font-size:.72rem;padding:3px 10px;border-radius:12px;backdrop-filter:blur(4px)}
.g-thumbs{display:flex;gap:.4rem;padding:.6rem .75rem;overflow-x:auto;background:var(--bg2);scrollbar-width:none;flex-shrink:0}
.g-thumbs::-webkit-scrollbar{display:none}
.g-thumb{width:54px;height:54px;object-fit:cover;border-radius:7px;cursor:pointer;opacity:.55;border:2px solid transparent;transition:.15s;flex-shrink:0}
.g-thumb.active{opacity:1;border-color:var(--accent)}
.g-thumb:hover{opacity:.85}
.g-info{padding:1rem 1.25rem;overflow-y:auto;flex:1}
.g-top{display:flex;align-items:flex-start;justify-content:space-between;gap:1rem;margin-bottom:.5rem}
.g-brand{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:.09em;color:var(--accent)}
.g-close{background:none;border:none;font-size:1.3rem;cursor:pointer;color:var(--muted);line-height:1;padding:2px;flex-shrink:0}
.g-name{font-family:'Playfair Display',serif;font-size:1.1rem;font-weight:700;line-height:1.3;margin-bottom:.45rem}
.g-stars{display:flex;align-items:center;gap:5px;margin-bottom:.6rem}
.g-meta{display:flex;flex-wrap:wrap;gap:.4rem;margin-bottom:.7rem}
.g-tag{font-size:.72rem;padding:3px 9px;border-radius:10px;background:var(--al);color:var(--muted)}
.g-desc{font-size:.82rem;color:var(--text2);line-height:1.6;margin-bottom:.9rem;max-height:80px;overflow-y:auto}
.g-footer{display:flex;align-items:center;justify-content:space-between;gap:.75rem;flex-wrap:wrap}
.g-price{font-family:'Playfair Display',serif;font-size:1.4rem;font-weight:700;color:var(--text)}
.g-buy{padding:9px 22px;border-radius:9px;background:var(--accent);color:#fff;border:none;font-family:'DM Sans',sans-serif;font-size:.88rem;font-weight:700;cursor:pointer;text-decoration:none;transition:.15s;display:inline-block}
.g-buy:hover{background:var(--ad)}
@media(max-width:600px){
  .gov{padding:0;align-items:flex-end}
  .gmodal{border-radius:20px 20px 0 0;max-height:95vh;max-width:100%}
  .g-main-img{height:260px}
  .g-name{font-size:.95rem}
  .g-price{font-size:1.2rem}
}
footer{border-top:1px solid var(--border);padding:1.4rem 2rem;text-align:center;font-size:.73rem;color:var(--muted);margin-top:3rem;transition:var(--transition)}
@media(max-width:900px){
  main{padding:1.25rem}
  .hstats{gap:1rem}.stat .sn{font-size:1.2rem}
  .grid{grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:.85rem}
  .controls{flex-wrap:wrap;gap:.45rem}.sp{display:none}
  .sw input{width:155px}
}
/* ‚îÄ‚îÄ MOBILE ‚îÄ‚îÄ */
@media(max-width:600px){
  header{padding:0 .85rem}
  .hi{height:54px;gap:.5rem}
  .logo{font-size:1.15rem}
  .ls{display:none}
  /* Mobile countdown - compact timer */
  .countdown-banner{padding:.75rem 1rem}
  .countdown-content{gap:.75rem;flex-direction:column}
  .countdown-label{font-size:.7rem;margin-bottom:.15rem}
  .countdown-timer{gap:.4rem;font-size:.85rem}
  .time-unit{min-width:45px}
  .time-value{font-size:1.4rem}
  .time-label{font-size:.58rem;margin-top:.15rem}
  .time-sep{font-size:1.1rem;margin:0 -.15rem}
  .status-pill{font-size:.65rem;padding:3px 9px}
  main{padding:.85rem}
  .hero{margin-bottom:1rem;gap:.45rem}
  .ht h1{font-size:1.4rem}
  .ht p{font-size:.78rem}
  .hstats{display:none}
  .tg{flex-wrap:nowrap;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none;width:100%}
  .tg::-webkit-scrollbar{display:none}
  .tab{white-space:nowrap;flex-shrink:0;font-size:.76rem;padding:5px 11px}
  .controls{flex-direction:row;flex-wrap:wrap;gap:.4rem;align-items:stretch}
  .sp{display:none}
  .sw{flex:1 1 100%}.sw input{width:100%}
  select{flex:1 1 calc(50% - .2rem);min-width:0;font-size:.74rem;padding:6px 7px}
  .rbtn{flex:1 1 100%;justify-content:center;padding:8px}
  .ppc{flex:1 1 100%;justify-content:flex-end}
  .grid{grid-template-columns:repeat(2,1fr);gap:.6rem}
  .ci{aspect-ratio:1}
  .rb{width:24px;height:24px;font-size:.64rem;top:6px;left:6px;min-width:24px;padding:0}
  .tb{font-size:.61rem;padding:2px 5px;top:6px;right:6px}
  .cb{padding:.62rem}
  .cbrand{font-size:.61rem}
  .cname{font-size:.79rem;line-height:1.3;margin-bottom:.38rem}
  .ctags{gap:.22rem;margin-bottom:.42rem}
  .tag{font-size:.59rem;padding:2px 5px}
  .price{font-size:.85rem}
  .score{font-size:.61rem}
  .bbtn{padding:5px 9px;font-size:.69rem}
  .gh{flex-wrap:wrap;gap:.35rem}
  .gh h2{font-size:.88rem}
  .rc{font-size:.69rem}
  .pagination{gap:.3rem;margin-top:1.5rem}
  .pg-btn{min-width:32px;height:32px;font-size:.74rem}
  footer{padding:1.1rem .85rem;font-size:.69rem}
  .toast-wrap{bottom:1rem;right:.85rem;left:.85rem}
  .toast{max-width:100%}
  .btt{bottom:1rem;left:.85rem}
}
@media(max-width:380px){
  .grid{grid-template-columns:repeat(2,1fr);gap:.45rem}
  .ht h1{font-size:1.2rem}
  .cname{font-size:.75rem}
  .cb{padding:.52rem}
  select{font-size:.7rem}
}
</style>
</head>
<body>
<header>
  <div class="hi">
    <div class="logo">Trendr<span class="ld">.</span><span class="ls">Daily Rankings</span></div>
    <div class="hright">
      <button class="theme-btn" id="themeBtn" onclick="toggleTheme()" title="Toggle dark mode">üåô</button>
    </div>
  </div>
</header>

<!-- COUNTDOWN BANNER -->
<div class="countdown-banner">
  <div class="countdown-content">
    <span class="countdown-label">Next Update In</span>
    <div class="countdown-timer">
      <div class="time-unit">
        <div class="time-value" id="hours">00</div>
        <div class="time-label">Hours</div>
      </div>
      <span class="time-sep">:</span>
      <div class="time-unit">
        <div class="time-value" id="minutes">00</div>
        <div class="time-label">Minutes</div>
      </div>
      <span class="time-sep">:</span>
      <div class="time-unit">
        <div class="time-value" id="seconds">00</div>
        <div class="time-label">Seconds</div>
      </div>
    </div>
    <div class="status-pill">
      <span class="status-dot"></span>
      <span id="statusText">Updated Today</span>
    </div>
  </div>
</div>

<button class="btt" id="bttBtn" onclick="window.scrollTo({top:0,behavior:'smooth'})" title="Back to top">‚Üë</button>
<div class="toast-wrap" id="toastWrap"></div>
<div class="gov" id="gov" onclick="closeGalleryOnBg(event)">
  <div class="gmodal">
    <div class="g-viewer">
      <img class="g-main-img" id="gMainImg" src="" alt=""/>
      <button class="g-nav prev" id="gPrev" onclick="gNav(-1)">‚Äπ</button>
      <button class="g-nav next" id="gNext" onclick="gNav(1)">‚Ä∫</button>
      <span class="g-counter" id="gCounter">1 / 1</span>
    </div>
    <div class="g-thumbs" id="gThumbs"></div>
    <div class="g-info">
      <div class="g-top">
        <div>
          <div class="g-brand" id="gBrand"></div>
        </div>
        <button class="g-close" onclick="closeGallery()">‚úï</button>
      </div>
      <div class="g-name" id="gName"></div>
      <div class="g-stars" id="gStars"></div>
      <div class="g-meta" id="gMeta"></div>
      <div class="g-desc" id="gDesc"></div>
      <div class="g-footer">
        <div class="g-price" id="gPrice"></div>
        <a class="g-buy" id="gBuy" href="#" target="_blank" rel="noopener">Buy Now ‚Üí</a>
      </div>
    </div>
  </div>
</div>
<main>
  <div class="hero">
    <div class="ht">
      <h1>Today's <em>Best Sellers</em></h1>
      <p>Daily rankings across 30,000+ brands ‚Äî <a href="https://trendrshop.me" style="color:var(--accent);text-decoration:none">trendrshop.me</a></p>
    </div>
    <div class="hstats">
      <div class="stat"><div class="sn" id="sBrands">‚Äî</div><div class="sl">Brands</div></div>
      <div class="stat"><div class="sn" id="sProds">‚Äî</div><div class="sl">Products</div></div>
    </div>
  </div>
  <div class="controls">
    <div class="tg">
      <button class="tab active" onclick="setCat('womens',this)">Women's</button>
      <button class="tab" onclick="setCat('mens',this)">Men's</button>
      <button class="tab" onclick="setCat('sneakers',this)">Sneakers</button>
      <button class="tab" onclick="setCat('accessories',this)">Accessories</button>
    </div>
    <div class="sp"></div>
    <div class="sw"><span class="si">üîç</span><input type="text" id="srch" placeholder="Search‚Ä¶" oninput="onFilterChange()"/></div>
    <select id="fBrand" onchange="onFilterChange()"><option value="">All Brands</option></select>
    <select id="fColor" onchange="onFilterChange()">
      <option value="">All Colors</option>
      <option>Black</option><option>White</option><option>Grey</option><option>Blue</option><option>Pink</option>
      <option>Green</option><option>Red</option><option>Purple</option><option>Brown</option><option>Beige</option>
    </select>
    <select id="fSize" onchange="onFilterChange()">
      <option value="">All Sizes</option>
      <option>XS</option><option>S</option><option>M</option><option>L</option><option>XL</option><option>XXL</option>
      <option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option>
    </select>
    <select id="fPrice" onchange="onFilterChange()">
      <option value="">Any Price</option>
      <option value="0-50">Under $50</option>
      <option value="50-100">$50 ‚Äì $100</option>
      <option value="100-200">$100 ‚Äì $200</option>
      <option value="200+">$200+</option>
    </select>
    <select id="fSort" onchange="onFilterChange()">
      <option value="rank">Top Ranked</option>
      <option value="price-asc">Price ‚Üë</option>
      <option value="price-desc">Price ‚Üì</option>
      <option value="score">Popularity</option>
    </select>
    <div class="ppc">
      <span>Show</span>
      <select id="perPage" onchange="onPerPageChange()">
        <option value="12">12</option>
        <option value="24">24</option>
        <option value="48">48</option>
        <option value="96">96</option>
      </select>
    </div>
  </div>
  <div class="gh">
    <div class="gh-left">
      <h2 id="gtitle">Women's ‚Äî All Brands</h2>
      <span class="rc" id="rcount"></span>
    </div>
  </div>
  <div class="grid" id="grid"></div>
  <div class="pagination" id="pagination"></div>
  <p class="pg-info" id="pgInfo"></p>
</main>
<footer>¬© 2025 <a href="https://trendrshop.me" style="color:var(--accent);text-decoration:none">trendrshop.me</a> &nbsp;¬∑&nbsp; Daily rankings across 30,000+ brands &nbsp;¬∑&nbsp; Updates daily at noon EST</footer>
<script>
'use strict';
const WORKER_URL = 'https://apiproxy.trendrconnect.workers.dev';
const UPDATE_HOUR = 12; // Noon (24-hour format, 0-23)
const UPDATE_TIMEZONE = 'America/New_York'; // EST/EDT

let cat = 'womens';
let allProds = [];
let filtered = [];
let currentPage = 1;
let perPage = 12;
let countdownInterval = null;

// DEMO DATA (fallback)
const I = {
  ll:'https://images.unsplash.com/photo-1506629082955-511b1aa562c8?w=500&q=75',
  nw:'https://images.unsplash.com/photo-1571945153237-4929e783af4a?w=500&q=75',
  ad:'https://images.unsplash.com/photo-1583744946564-b52ac1c389c8?w=500&q=75',
  fp:'https://images.unsplash.com/photo-1485462537746-965f33f39ed0?w=500&q=75',
  as:'https://images.unsplash.com/photo-1434682881908-b43d0467b798?w=500&q=75',
  pu:'https://images.unsplash.com/photo-1578681994506-b8f463449011?w=500&q=75',
  rv:'https://images.unsplash.com/photo-1552902865-b72c031ac5ea?w=500&q=75',
  za:'https://images.unsplash.com/photo-1445205170230-053b83016050?w=500&q=75',
  an:'https://images.unsplash.com/photo-1539109136881-3be0616acf4b?w=500&q=75',
  nm:'https://images.unsplash.com/photo-1556821840-3a63f15732ce?w=500&q=75',
  nf:'https://images.unsplash.com/photo-1512436991641-6745cdb1723f?w=500&q=75',
  nb:'https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=500&q=75',
  ch:'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=500&q=75',
  jd:'https://images.unsplash.com/photo-1556906781-9a412961a28c?w=500&q=75',
  cn:'https://images.unsplash.com/photo-1587825140708-dfaf72ae4b04?w=500&q=75',
  vn:'https://images.unsplash.com/photo-1525966222134-fcfa99b8ae77?w=500&q=75',
  hm:'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=500&q=75',
  mg:'https://images.unsplash.com/photo-1595777457583-95e059d581b8?w=500&q=75',
};
const P = (r,br,n,pr,co,sz,sc,tr,im,url,src='demo') => ({rank:r,brand:br,name:n,price:pr,color:co,size:sz,sales:sc,trend:tr,img:I[im]||I.as,url,src,photos:[I[im]||I.as]});
const DEMO = {
  womens:[
    P(1,'Lululemon','Align High-Rise Pant 28"',128,'Black','M',18420,'up','ll','https://lululemon.com'),
    P(2,'Nike','Dri-FIT One Luxe Tight',75,'Grey','S',15300,'up','nw','https://nike.com'),
    P(3,'Adidas','Essentials 3-Stripes Hoodie',55,'White','L',12900,'same','ad','https://adidas.com'),
    P(4,'Free People','Movement Sunny Side Legging',98,'Pink','XS',10100,'up','fp','https://freepeople.com'),
    P(5,'ASOS','Premium Floral Midi Dress',68,'Blue','M',9800,'down','as','https://asos.com'),
    P(6,'Revolve','NBD Mini Dress',158,'Black','XS',9100,'up','rv','https://revolve.com'),
    P(7,'Zara','Ribbed Knit Cardigan',39,'Beige','M',8700,'up','za','https://zara.com'),
    P(8,'Anthropologie','Denim Embroidered Jacket',148,'Blue','S',8200,'same','an','https://anthropologie.com'),
    P(9,'Puma','Favourite Blaster Jacket',85,'Black','XL',7600,'up','pu','https://puma.com'),
    P(10,'H&M','Flowy Satin Blouse',24,'White','M',7100,'down','hm','https://hm.com'),
    P(11,'Mango','Asymmetric Hem Dress',59,'Black','S',6800,'up','mg','https://mango.com'),
    P(12,'Lululemon','Swiftly Tech Long Sleeve',88,'Green','M',6400,'same','fp','https://lululemon.com'),
  ],
  mens:[
    P(1,'Nike','Tech Fleece Full-Zip Hoodie',130,'Black','L',21000,'up','nm','https://nike.com'),
    P(2,'Adidas','Tiro 23 Track Jacket',70,'Blue','M',16500,'up','ad','https://adidas.com'),
    P(3,'Lululemon','ABC Slim-Fit Chino',148,'Grey','M',13400,'same','ll','https://lululemon.com'),
    P(4,'The North Face','Apex Bionic Jacket',229,'Black','L',11800,'up','nf','https://thenorthface.com'),
    P(5,'Champion','Reverse Weave Hoodie',75,'Grey','XL',10200,'up','ch','https://champion.com'),
    P(6,'Puma','Essentials Logo Shorts',35,'Grey','M',9400,'same','pu','https://puma.com'),
    P(7,'H&M','Regular Fit Oxford Shirt',29,'White','M',8900,'down','hm','https://hm.com'),
    P(8,'Zara','Straight Leg Chino',49,'Beige','M',8400,'up','za','https://zara.com'),
    P(9,'ASOS','Slim Suit Jacket',89,'Blue','M',7800,'same','as','https://asos.com'),
    P(10,'Adidas','Ultraboost Running Tee',35,'White','L',7200,'up','ad','https://adidas.com'),
    P(11,'Nike','Pro Dri-FIT Shorts',40,'Black','M',6800,'up','nm','https://nike.com'),
    P(12,'Lululemon','Surge Hybrid Short',98,'Blue','L',6100,'down','ll','https://lululemon.com'),
  ],
  sneakers:[
    P(1,'Nike','Air Force 1 \'07',110,'White','10',24500,'up','vn','https://nike.com'),
    P(2,'New Balance','574 Core',89,'Grey','9',19300,'up','nb','https://newbalance.com'),
    P(3,'Adidas','Stan Smith',90,'White','10',17800,'same','ad','https://adidas.com'),
    P(4,'Jordan','Air Jordan 1 Retro High',180,'Black','11',15600,'up','jd','https://jordan.com'),
    P(5,'Converse','Chuck Taylor All Star',65,'Black','9',13900,'same','cn','https://converse.com'),
    P(6,'Vans','Old Skool',70,'Black','10',12400,'up','vn','https://vans.com'),
    P(7,'Asics','Gel-Nimbus 25',160,'Blue','10',10800,'up','as','https://asics.com'),
    P(8,'Puma','RS-X Sneakers',90,'White','9',8700,'up','pu','https://puma.com'),
    P(9,'Nike','React Infinity Run Flyknit',160,'Blue','10',7900,'same','nw','https://nike.com'),
    P(10,'New Balance','990v5 Made in USA',185,'Grey','11',7200,'up','nb','https://newbalance.com'),
    P(11,'Adidas','Ultraboost 22',190,'Black','10',6500,'down','ad','https://adidas.com'),
    P(12,'Champion','C Logo Low Cut',65,'White','9',5900,'same','ch','https://champion.com'),
  ],
  accessories:[
    P(1,'Lululemon','Everywhere Belt Bag 1L',38,'Black','',14200,'up','ll','https://lululemon.com'),
    P(2,'Nike','Heritage Backpack',55,'Grey','',11800,'up','nm','https://nike.com'),
    P(3,'ASOS','Oversized Square Sunglasses',22,'Black','',10400,'same','as','https://asos.com'),
    P(4,'Adidas','Linear Core Tote Bag',30,'Black','',9600,'up','ad','https://adidas.com'),
    P(5,'Zara','Chain Detail Bucket Hat',25,'Beige','',8800,'up','za','https://zara.com'),
    P(6,'Revolve','LACK OF COLOR Boater Hat',68,'Black','',8100,'down','rv','https://revolve.com'),
    P(7,'Free People','Sol Searcher Crossbody',68,'Brown','',7500,'same','fp','https://freepeople.com'),
    P(8,'Puma','Training Gym Bag',45,'Black','',6900,'up','pu','https://puma.com'),
    P(9,'H&M','Ribbed Knit Beanie',12,'Grey','',6200,'up','hm','https://hm.com'),
    P(10,'Mango','Mini Croc-Effect Bag',59,'Black','',5800,'down','mg','https://mango.com'),
    P(11,'The North Face','Base Camp Duffel S',110,'Black','',5300,'same','nf','https://thenorthface.com'),
    P(12,'Champion','Script Logo Cap',28,'White','',4900,'up','ch','https://champion.com'),
  ]
};

function initTheme() {
  const saved = localStorage.getItem('trendr_theme');
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const theme = saved || (prefersDark ? 'dark' : 'light');
  applyTheme(theme);
}
function applyTheme(theme) {
  document.documentElement.setAttribute('data-theme', theme);
  document.getElementById('themeBtn').textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
  localStorage.setItem('trendr_theme', theme);
}
function toggleTheme() {
  const cur = document.documentElement.getAttribute('data-theme');
  applyTheme(cur === 'dark' ? 'light' : 'dark');
  toast(cur === 'dark' ? '‚òÄÔ∏è Light mode' : 'üåô Dark mode');
}

function toast(msg, dur=2200) {
  const wrap = document.getElementById('toastWrap');
  const el = document.createElement('div');
  el.className = 'toast';
  el.textContent = msg;
  wrap.appendChild(el);
  requestAnimationFrame(() => { el.classList.add('show'); });
  setTimeout(() => {
    el.classList.remove('show');
    setTimeout(() => el.remove(), 300);
  }, dur);
}

window.addEventListener('scroll', () => {
  const btn = document.getElementById('bttBtn');
  if (window.scrollY > 400) btn.classList.add('visible');
  else btn.classList.remove('visible');
}, { passive: true });

const CLABELS = {womens:"Women's",mens:"Men's",sneakers:"Sneakers",accessories:"Accessories"};
function setCat(c, btn) {
  cat = c; currentPage = 1;
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  btn.classList.add('active');
  ['fBrand','fColor','fSize','fPrice','fSort'].forEach(id=>document.getElementById(id).selectedIndex=0);
  document.getElementById('srch').value='';
  loadData();
}
function populateBrands(prods) {
  const brands = [...new Set(prods.map(p=>p.brand))].sort();
  const sel = document.getElementById('fBrand');
  const cur = sel.value;
  sel.innerHTML = '<option value="">All Brands</option>'+brands.map(b=>`<option${b===cur?' selected':''}>${b}</option>`).join('');
}

function onFilterChange() { currentPage = 1; applyFilters(); }
function onPerPageChange() { perPage = parseInt(document.getElementById('perPage').value); currentPage = 1; renderPage(); }
function applyFilters() {
  let f = [...allProds];
  const brand = document.getElementById('fBrand').value;
  const color = document.getElementById('fColor').value;
  const size  = document.getElementById('fSize').value;
  const price = document.getElementById('fPrice').value;
  const sort  = document.getElementById('fSort').value;
  const srch  = document.getElementById('srch').value.toLowerCase().trim();
  if (brand) f = f.filter(p=>p.brand===brand);
  if (color) f = f.filter(p=>p.color.toLowerCase().includes(color.toLowerCase()));
  if (size)  f = f.filter(p=>!p.size||p.size===size);
  if (srch)  f = f.filter(p=>p.name.toLowerCase().includes(srch)||p.brand.toLowerCase().includes(srch));
  if (price==='200+') f=f.filter(p=>p.price>=200);
  else if(price){const[lo,hi]=price.split('-').map(Number);f=f.filter(p=>p.price>=lo&&p.price<=hi);}
  if(sort==='price-asc')  f.sort((a,b)=>a.price-b.price);
  if(sort==='price-desc') f.sort((a,b)=>b.price-a.price);
  if(sort==='score')      f.sort((a,b)=>b.sales-a.sales);
  if(sort==='rank')       f.sort((a,b)=>a.rank-b.rank);
  filtered = f;
  const bl = brand||'All Brands';
  const cl = color?` ¬∑ ${color}`:'';
  document.getElementById('gtitle').textContent = `${CLABELS[cat]} ‚Äî ${bl}${cl}`;
  document.getElementById('rcount').textContent = `${f.length} item${f.length!==1?'s':''}`;
  renderPage();
}

function renderPage() {
  const total = filtered.length;
  const totalPages = Math.max(1, Math.ceil(total / perPage));
  if (currentPage > totalPages) currentPage = totalPages;
  const start = (currentPage - 1) * perPage;
  const end   = Math.min(start + perPage, total);
  const pageItems = filtered.slice(start, end);
  renderProds(pageItems);
  renderPagination(totalPages);
  if (total > 0) {
    document.getElementById('pgInfo').textContent = `Showing ${start+1}‚Äì${end} of ${total} items`;
  } else {
    document.getElementById('pgInfo').textContent = '';
  }
}
function goPage(n) {
  currentPage = n;
  renderPage();
  document.getElementById('grid').scrollIntoView({behavior:'smooth', block:'start'});
}
function renderPagination(totalPages) {
  const pg = document.getElementById('pagination');
  if (totalPages <= 1) { pg.innerHTML = ''; return; }
  const cur = currentPage;
  let html = '';
  html += `<button class="pg-btn" onclick="goPage(${cur-1})" ${cur===1?'disabled':''}>‚Äπ</button>`;
  const pages = getPageNumbers(cur, totalPages);
  pages.forEach(p => {
    if (p === '...') {
      html += `<button class="pg-btn pg-dots" disabled>‚Ä¶</button>`;
    } else {
      html += `<button class="pg-btn${p===cur?' active':''}" onclick="goPage(${p})">${p}</button>`;
    }
  });
  html += `<button class="pg-btn" onclick="goPage(${cur+1})" ${cur===totalPages?'disabled':''}>‚Ä∫</button>`;
  pg.innerHTML = html;
}
function getPageNumbers(cur, total) {
  if (total <= 7) return Array.from({length:total},(_,i)=>i+1);
  const pages = [];
  pages.push(1);
  if (cur > 3) pages.push('...');
  for (let i = Math.max(2, cur-1); i <= Math.min(total-1, cur+1); i++) pages.push(i);
  if (cur < total-2) pages.push('...');
  pages.push(total);
  return pages;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// COUNTDOWN & AUTO-UPDATE SYSTEM
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function getNextUpdateTime() {
  const now = new Date();
  const updateTime = new Date(now.toLocaleString('en-US', { timeZone: UPDATE_TIMEZONE }));
  updateTime.setHours(UPDATE_HOUR, 0, 0, 0);
  
  if (new Date(now.toLocaleString('en-US', { timeZone: UPDATE_TIMEZONE })) >= updateTime) {
    updateTime.setDate(updateTime.getDate() + 1);
  }
  
  return new Date(updateTime.toLocaleString('en-US', { timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone }));
}

function pad(n) { return n.toString().padStart(2, '0'); }

function updateCountdown() {
  const nextUpdate = getNextUpdateTime();
  const now = Date.now();
  const remaining = nextUpdate - now;
  
  if (remaining > 0) {
    const hours = Math.floor(remaining / 3600000);
    const minutes = Math.floor((remaining % 3600000) / 60000);
    const seconds = Math.floor((remaining % 60000) / 1000);
    
    document.getElementById('hours').textContent = pad(hours);
    document.getElementById('minutes').textContent = pad(minutes);
    document.getElementById('seconds').textContent = pad(seconds);
  } else {
    document.getElementById('hours').textContent = '00';
    document.getElementById('minutes').textContent = '00';
    document.getElementById('seconds').textContent = '00';
    checkForUpdate();
  }
}

function startCountdown() {
  updateCountdown();
  if (countdownInterval) clearInterval(countdownInterval);
  countdownInterval = setInterval(updateCountdown, 1000); // Update every second
}

// CACHING SYSTEM
function getCacheKey() { return `trendr_cache_${cat}_v2`; }
function getLastUpdateKey() { return 'trendr_last_update'; }

function getCachedData() {
  try {
    const cached = localStorage.getItem(getCacheKey());
    if (!cached) return null;
    const { data, timestamp } = JSON.parse(cached);
    console.log(`‚úÖ Loaded from cache (${new Date(timestamp).toLocaleString()})`);
    return data;
  } catch(e) { return null; }
}

function setCachedData(data) {
  try {
    const timestamp = Date.now();
    localStorage.setItem(getCacheKey(), JSON.stringify({ data, timestamp }));
    localStorage.setItem(getLastUpdateKey(), timestamp.toString());
  } catch(e) { console.warn('Cache save failed:', e); }
}

function shouldUpdate() {
  const lastUpdate = localStorage.getItem(getLastUpdateKey());
  if (!lastUpdate) return true;
  
  const lastUpdateDate = new Date(parseInt(lastUpdate));
  const lastUpdateEST = new Date(lastUpdateDate.toLocaleString('en-US', { timeZone: UPDATE_TIMEZONE }));
  const nowEST = new Date(new Date().toLocaleString('en-US', { timeZone: UPDATE_TIMEZONE }));
  
  const todayUpdate = new Date(nowEST);
  todayUpdate.setHours(UPDATE_HOUR, 0, 0, 0);
  
  return lastUpdateEST < todayUpdate && nowEST >= todayUpdate;
}

async function checkForUpdate() {
  if (shouldUpdate()) {
    console.log('üîÑ Auto-updating data...');
    toast('üîÑ Fetching latest rankings...', 3000);
    await loadData(true);
  }
}

async function loadData(forceRefresh = false) {
  showSkel();
  
  let loaded = false;
  
  if (!forceRefresh && !shouldUpdate()) {
    const cached = getCachedData();
    if (cached) {
      allProds = cached;
      loaded = true;
      const lastUpdate = parseInt(localStorage.getItem(getLastUpdateKey()));
      const updateDate = new Date(lastUpdate);
      document.getElementById('statusText').textContent = `Updated ${updateDate.toLocaleDateString('en-US', {month:'short', day:'numeric'})}`;
    }
  }
  
  if (!loaded) {
    try { 
      await fetchRapid(); 
      setCachedData(allProds);
      loaded = true;
      const updateDate = new Date();
      document.getElementById('statusText').textContent = `Updated ${updateDate.toLocaleDateString('en-US', {month:'short', day:'numeric'})}`;
    }
    catch(e) {
      console.warn('API error:', e.message);
      toast(`‚ö†Ô∏è ${e.message || 'API error'} ‚Äî showing demo data`, 4000);
    }
  }
  
  if (!loaded) {
    await new Promise(r=>setTimeout(r,350));
    allProds = DEMO[cat];
    document.getElementById('statusText').textContent = 'Demo Data';
  }
  
  populateBrands(allProds);
  document.getElementById('sProds').textContent = allProds.length;
  document.getElementById('sBrands').textContent = [...new Set(allProds.map(p=>p.brand))].length;
  applyFilters();
  startCountdown();
}

const QUERIES = {
  womens:['Nike womens leggings tights sports bra','Adidas womens hoodie jacket tracksuit','Zara H&M ASOS womens dress top'],
  mens:['Nike mens hoodie joggers tracksuit','Adidas mens jacket shorts t-shirt','Zara H&M mens shirt chino trousers'],
  sneakers:['Nike Air Force Jordan sneakers shoes','Adidas Stan Smith Ultraboost sneakers','New Balance Converse Vans sneakers'],
  accessories:['Nike Adidas sports bag backpack','Lululemon belt bag crossbody purse','sunglasses hat cap beanie fashion'],
};
const BRANDS_DB = ['Nike','Adidas','Lululemon','Under Armour','Puma','New Balance','Reebok','Converse','Vans','Jordan','Asics','Fila','Saucony','Brooks','Champion','H&M','Zara','ASOS','Revolve','Free People','Anthropologie','Urban Outfitters','Mango','Ted Baker','Nordstrom','J.Crew','Gap','Old Navy','Banana Republic','Express','Forever 21','Patagonia','The North Face','Columbia','Uniqlo','Carhartt','Gymshark','Sweaty Betty','Arc\'teryx','Ralph Lauren','Tommy Hilfiger','Calvin Klein','Levis'];

async function fetchRapid() {
  const queries = QUERIES[cat].slice(0, 3);
  const results = await Promise.allSettled(queries.map(q =>
    fetch(`${WORKER_URL}?q=${encodeURIComponent(q)}&category=${cat}`)
      .then(r => { if(!r.ok) throw new Error(`HTTP ${r.status}`); return r.json(); })
  ));
  const seen = new Set();
  const raw = [];
  results.forEach(r => {
    if (r.status === 'fulfilled') {
      const items = r.value?.data?.products || r.value?.products || r.value?.data || [];
      items.forEach(p => {
        const id = p.product_id || p.product_title;
        if (id && !seen.has(id)) { seen.add(id); raw.push(p); }
      });
    }
  });
  if (!raw.length) throw new Error('No products returned');
  const mapped = raw.map((p,i)=>{
    const photos = (p.product_photos||[]).filter(u=>u&&u.length>10);
    const img = photos[0] || I.as;
    const rawUrl = p.offer?.store_link || p.offer?.offer_page_url || p.product_page_url || '';
    const url2 = rawUrl.startsWith('http') ? rawUrl : (rawUrl ? 'https://'+rawUrl : '#');
    const priceRaw = p.offer?.price || p.typical_price_range?.[0] || '0';
    const price = parseFloat(priceRaw.toString().replace(/[^0-9.]/g,'')) || 0;
    const searchText = [p.product_title, p.product_description, ...(p.product_highlights||[])].join(' ');
    const color = exColor(searchText);
    const size = exSize(searchText);
    const rating  = parseFloat(p.product_rating) || 0;
    const reviews = parseInt(p.reviews?.total_reviews) || 0;
    const desc = (p.product_description||'').slice(0,160).trim();
    const score = rankSc(p, i);
    return {
      rank:i+1,
      brand: exBrand(p.product_title),
      name: (p.product_title||'Unknown Product').replace(/[<>]/g,'').slice(0,70),
      price, color, size,
      rating, reviews,
      desc,
      sales: score,
      trend: score>5000?'up':score>1000?'same':'down',
      img,
      photos,
      url: url2,
      src:'rapidapi'
    };
  });
  mapped.sort((a,b)=>b.sales-a.sales);
  const deduped = [];
  const namesSeen = new Set();
  mapped.forEach(p => {
    const key2 = p.name.toLowerCase().slice(0,30);
    if (!namesSeen.has(key2)) { namesSeen.add(key2); deduped.push(p); }
  });
  deduped.forEach((p,i)=>p.rank=i+1);
  allProds = deduped;
  toast(`‚úÖ Loaded ${deduped.length} products from ${[...new Set(deduped.map(p=>p.brand))].length} brands`);
}
function rankSc(p, fallbackIdx=0){
  const reviews = parseInt(p.reviews?.total_reviews) || 0;
  const rating  = parseFloat(p.product_rating) || 0;
  const bestSeller = p.is_best_seller ? 2000 : 0;
  const sponsored  = p.is_sponsored   ? -500  : 0;
  const base = reviews > 0 ? (reviews * rating) : (100 - fallbackIdx * 5);
  return Math.round(base + bestSeller + sponsored);
}
function exBrand(t=''){ return BRANDS_DB.find(b=>t.toLowerCase().includes(b.toLowerCase()))||'Brand'; }
function exColor(t=''){ return ['Black','White','Grey','Gray','Blue','Navy','Pink','Green','Red','Purple','Brown','Beige','Tan','Orange','Yellow','Cream','Ivory','Coral','Teal','Olive','Burgundy','Maroon','Lavender','Mint','Khaki','Camel'].find(c=>t.toLowerCase().includes(c.toLowerCase()))||''; }
function exSize(t=''){
  const m = t.match(/\b(XXS|XS|XSmall|Small|Medium|Large|XL|XXL|XXXL|2XL|3XL|EU\s?\d+|US\s?\d+|\bsize\s+(\w+))\b/i);
  if (m) return m[0].replace(/size\s+/i,'').trim();
  const shoe = t.match(/\b(US\s?)?(5|5\.5|6|6\.5|7|7\.5|8|8\.5|9|9\.5|10|10\.5|11|11\.5|12|13)\b/);
  return shoe ? shoe[0].trim() : '';
}

function renderProds(prods) {
  const grid = document.getElementById('grid');
  if (!prods.length) {
    grid.innerHTML = `<div class="empty"><div class="ei">üîç</div><p>No items match ‚Äî try different filters.</p></div>`;
    return;
  }
  const frag = document.createDocumentFragment();
  prods.forEach((p, i) => {
    const card = document.createElement('div');
    card.className = 'card';
    card.style.animationDelay = `${i * 0.035}s`;
    card.setAttribute('onclick', `openGallery(${i + (currentPage-1)*perPage})`);
    card.style.cursor = 'pointer';
    const stars = p.rating ? renderStars(p.rating) : '';
    const reviewTxt = p.reviews ? `<span class="rev-count">(${p.reviews.toLocaleString()})</span>` : '';
    card.innerHTML = `
      <div class="ci">
        <img data-src="${p.img}" alt="${p.name}" loading="lazy" onerror="this.src='${I.as}'"/>
        <div class="rb ${rc(p.rank)}">#${p.rank}</div>
        <span class="tb ${tc(p.trend)}">${ti(p.trend)} ${cap(p.trend)}</span>
        ${(p.photos||[]).length > 1 ? `<span class="photo-count">üì∑ ${p.photos.length}</span>` : ''}
      </div>
      <div class="cb">
        <div class="ct"><span class="cbrand">${p.brand}</span><span class="sb s-${p.src}">${sl(p.src)}</span></div>
        <div class="cname">${p.name}</div>
        ${stars ? `<div class="stars-row">${stars}${reviewTxt}</div>` : ''}
        <div class="ctags">
          ${p.color ? `<span class="tag">üé® ${p.color}</span>` : ''}
          ${p.size  ? `<span class="tag">üìè ${p.size}</span>`  : ''}
          ${p.sales > 5000 ? '<span class="tag">üî• Hot</span>' : ''}
        </div>
        <div class="cf">
          <div><div class="price">${p.price > 0 ? '$' + p.price.toFixed(2) : '‚Äî'}</div><div class="score">${p.sales.toLocaleString()} score</div></div>
          <a class="bbtn" href="${p.url}" target="_blank" rel="noopener" onclick="event.stopPropagation()">Buy ‚Üí</a>
        </div>
      </div>`;
    frag.appendChild(card);
  });
  grid.innerHTML = '';
  grid.appendChild(frag);
  const imgs = grid.querySelectorAll('img[data-src]');
  if ('IntersectionObserver' in window) {
    const obs = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          const img = e.target;
          img.src = img.dataset.src;
          img.onload = () => img.classList.add('loaded');
          img.onerror = () => { img.src = I.as; img.classList.add('loaded'); };
          obs.unobserve(img);
        }
      });
    }, { rootMargin: '200px' });
    imgs.forEach(img => obs.observe(img));
  } else {
    imgs.forEach(img => { img.src = img.dataset.src; img.classList.add('loaded'); });
  }
}
function renderStars(rating) {
  const full = Math.floor(rating);
  const half = rating % 1 >= 0.5 ? 1 : 0;
  const empty = 5 - full - half;
  return `<span class="stars">${'‚òÖ'.repeat(full)}${'¬Ω'.repeat(half)}${'‚òÜ'.repeat(empty)}</span><span class="rating-num">${rating.toFixed(1)}</span>`;
}

function showSkel() {
  document.getElementById('grid').innerHTML = Array(Math.min(perPage, 12)).fill(`
    <div class="csk"><div class="sk skim"></div>
    <div class="skb"><div class="sk skl s"></div><div class="sk skl m"></div><div class="sk skl s"></div></div></div>`).join('');
  document.getElementById('pagination').innerHTML = '';
  document.getElementById('pgInfo').textContent = '';
}

function rc(r){ return r===1?'r1':r===2?'r2':r===3?'r3':'rn'; }
function tc(t){ return t==='up'?'tu':t==='down'?'td':'ts2'; }
function ti(t){ return t==='up'?'‚Üë':t==='down'?'‚Üì':'‚Äî'; }
function cap(s){ return s.charAt(0).toUpperCase()+s.slice(1); }
function sl(s){ return {rapidapi:'Live',demo:'Demo'}[s]||'Demo'; }

let gProduct = null;
let gPhotoIdx = 0;
function openGallery(idx) {
  const p = filtered[idx];
  if (!p) return;
  gProduct = p;
  gPhotoIdx = 0;
  const photos = (p.photos && p.photos.length) ? p.photos : [p.img];
  document.getElementById('gBrand').textContent = p.brand;
  document.getElementById('gName').textContent = p.name;
  document.getElementById('gDesc').textContent = p.desc || 'No description available.';
  document.getElementById('gPrice').textContent = p.price > 0 ? '$' + p.price.toFixed(2) : '‚Äî';
  document.getElementById('gBuy').href = p.url;
  const starsEl = document.getElementById('gStars');
  if (p.rating) {
    starsEl.innerHTML = `<span class="stars" style="color:#f5a623;font-size:.9rem">${renderStarsStr(p.rating)}</span>
      <span class="rating-num">${p.rating.toFixed(1)}</span>
      ${p.reviews ? `<span class="rev-count">(${p.reviews.toLocaleString()} reviews)</span>` : ''}`;
  } else { starsEl.innerHTML = ''; }
  const meta = document.getElementById('gMeta');
  meta.innerHTML = [
    p.color ? `<span class="g-tag">üé® ${p.color}</span>` : '',
    p.size  ? `<span class="g-tag">üìè ${p.size}</span>`  : '',
    p.sales > 5000 ? '<span class="g-tag">üî• Trending</span>' : '',
    `<span class="g-tag">#${p.rank} Ranked</span>`,
    p.trend === 'up' ? '<span class="g-tag">‚Üë Rising</span>' : '',
  ].filter(Boolean).join('');
  const thumbs = document.getElementById('gThumbs');
  thumbs.innerHTML = photos.map((url, i) =>
    `<img class="g-thumb${i===0?' active':''}" src="${url}" onclick="gSetPhoto(${i})" onerror="this.style.display='none'" alt="Photo ${i+1}"/>`
  ).join('');
  thumbs.style.display = photos.length > 1 ? 'flex' : 'none';
  document.getElementById('gPrev').style.display = photos.length > 1 ? '' : 'none';
  document.getElementById('gNext').style.display = photos.length > 1 ? '' : 'none';
  gSetPhoto(0);
  document.getElementById('gov').classList.add('open');
  document.body.style.overflow = 'hidden';
}
function gSetPhoto(idx) {
  const photos = (gProduct?.photos?.length) ? gProduct.photos : [gProduct?.img || ''];
  if (idx < 0) idx = photos.length - 1;
  if (idx >= photos.length) idx = 0;
  gPhotoIdx = idx;
  const mainImg = document.getElementById('gMainImg');
  mainImg.classList.add('fading');
  setTimeout(() => {
    mainImg.src = photos[idx];
    mainImg.onload = () => mainImg.classList.remove('fading');
    mainImg.onerror = () => { mainImg.src = I.as; mainImg.classList.remove('fading'); };
  }, 150);
  document.getElementById('gCounter').textContent = `${idx + 1} / ${photos.length}`;
  document.querySelectorAll('.g-thumb').forEach((t, i) => {
    t.classList.toggle('active', i === idx);
  });
}
function gNav(dir) { gSetPhoto(gPhotoIdx + dir); }
function closeGallery() {
  document.getElementById('gov').classList.remove('open');
  document.body.style.overflow = '';
}
function closeGalleryOnBg(e) { if (e.target.id === 'gov') closeGallery(); }
document.addEventListener('keydown', e => {
  const open = document.getElementById('gov').classList.contains('open');
  if (!open) return;
  if (e.key === 'ArrowRight') gNav(1);
  if (e.key === 'ArrowLeft')  gNav(-1);
  if (e.key === 'Escape')     closeGallery();
});
function renderStarsStr(r) {
  const full = Math.floor(r);
  const half = r % 1 >= 0.5;
  return '‚òÖ'.repeat(full) + (half ? '¬Ω' : '') + '‚òÜ'.repeat(5 - full - (half?1:0));
}

initTheme();
loadData();
</script>
</body>
</html>
